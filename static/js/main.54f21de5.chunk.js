(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(t,e,a){},107:function(t,e,a){},110:function(t,e,a){},185:function(t,e){},186:function(t,e){},198:function(t,e,a){"use strict";a.r(e);var n=a(0),o=a.n(n),i=a(62),s=a.n(i),r=(a(106),a(107),a(2)),l=a.n(r),c=a(6),h=a(5),d=a(13),u=a(18),p=a(16),f=a(17),m=(a(110),a(1)),v=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(h.a)(this,t);var o=a(68),i=!!n;this.dataIndex=e,this.labelText="",this.baseColor=i?n.baseColor:"#aa00ff",this.radius=40,this.shadowMargin=7,this.shadowMargin=i?n.shadowMargin:7,this.shadowPushBack=1,this.textPullForward=-5,this.shadow={},this.shadow.geometry=new m.d(this.radius+this.shadowMargin,32),this.shadow.mesh=new m.g(this.shadow.geometry),this.shadow.mesh.material=new m.h({color:"#cccccc"}),this.object={},this.object.geometry=new m.d(this.radius,32),this.object.mesh=new m.g(this.object.geometry),this.object.mesh.material=new m.h({color:this.baseColor}),this.object.mesh.position.set(0,0,0),this.shadow.mesh.position.set(0,0,this.shadowPushBack),this.position=this.object.mesh.position,this.shadow.position=this.shadow.mesh.position,this.object.scale=this.object.mesh.scale,this.shadow.scale=this.shadow.mesh.scale,this.withinCircle=function(t,e){var a=this.object.mesh.position,n=!(Math.sqrt((t-a.x)*(t-a.x)+(e-a.y)*(e-a.y))>this.radius);return n},this.adjustScale=function(t){this.radius=t;var e=this.radius/40;this.object.scale.set(e,e,e),this.shadow.scale.set(e,e,e)},this.appendText=function(t,e,a,n){this.labelText=e;var o=new m.k(e,{font:t,size:13,height:5,curveSegments:12,bevelEnabled:!1,bevelThickness:1,bevelSize:2,bevelSegments:5}),i=new m.h({color:0});this.textMesh=new m.g(o,i),this.moveText(a,n),this.textMesh.rotation.set(0,0,Math.PI),this.changeTextSize(this.radius)},this.moveText=function(t,e){var a=(new m.b).setFromObject(this.textMesh);this.textMesh.position.set(t+.5*(a.max.x-a.min.x),e,this.textPullForward)},this.moveIndexText=function(t,e){var a=(new m.b).setFromObject(this.indexTextMesh);this.indexTextMesh.position.set(t+.5*(a.max.x-a.min.x),e,this.textPullForward)},this.setPosition=function(t,e,a){this.position.set(t,e,a),this.shadow.position.set(t,e,this.shadowPushBack)},this.changeTextSize=function(t){var e=t/40;this.textMesh.scale.set(e,e,e+this.textPullForward)},this.changeIndexTextSize=function(t){var e=t/40;this.indexTextMesh.scale.set(e,e,e+this.textPullForward)},this.transformColor=function(t){return o({r:t[0],g:t[1],b:t[2]}).toHexString()},this.changeColor=function(t){this.baseColor=this.transformColor(t),this.object.mesh.material.color.set(this.baseColor.toString())},this.lightenColor=function(t){this.object.mesh.material.color.set(o(this.baseColor).lighten(t).toString())},this.darkenColor=function(t){this.object.mesh.material.color.set(o(this.baseColor).darken(t).toString())},this.showIndex=function(t){var e=new m.k(this.dataIndex.toString(),{font:t,size:10,height:5,curveSegments:12,bevelEnabled:!1,bevelThickness:1,bevelSize:2,bevelSegments:5}),a=new m.h({color:8421504});this.indexTextMesh=new m.g(e,a),this.moveIndexText(this.position.x,this.position.y+.75*this.radius),this.indexTextMesh.rotation.set(0,0,Math.PI),this.changeIndexTextSize(this.radius)},i&&(this.adjustScale(n.radius),this.object.mesh.position.set(n.position.x,n.position.y,n.position.z),this.shadow.mesh.position.set(n.shadow.position.x,n.shadow.position.y,n.shadow.position.z)),this.update=function(){}},x=a(92),w=function(){function t(){Object(h.a)(this,t)}return Object(d.a)(t,[{key:"sleep",value:function(t){return new Promise(function(e){return setTimeout(e,t)})}}]),t}(),g=function t(e,a,n){Object(h.a)(this,t);this.stepLength=0,this.yPos=n,this.bar={},this.progress={},this.start={},this.stop={},this.bar.geometry=new m.c(500,20,1),this.bar.mesh=new m.g(this.bar.geometry),this.bar.mesh.material=new m.h({color:"#afafaf"}),this.progressLength=0,this.progress.geometry=new m.c(this.progressLength,20,1),this.progress.mesh=new m.g(this.progress.geometry),this.progress.mesh.material=new m.h({color:"#666666"}),this.bar.mesh.position.set(0,this.yPos,0),this.progress.mesh.position.set((500-this.progressLength)/2,this.yPos,0),e.add(this.bar.mesh),e.add(this.progress.mesh),this.updateProgress=function(t,e){this.stepLength*t<=500&&(this.progressLength=this.stepLength*t,this.progress.mesh.geometry=new m.c(this.progressLength,20,1),this.progress.mesh.position.set((500-this.progressLength)/2,this.yPos,0),this.appendText(e))},this.appendText=function(t){null!=this.textMesh&&e.remove(this.textMesh);var n=new m.k(t,{font:a,size:10,height:5,curveSegments:12,bevelEnabled:!1,bevelThickness:1,bevelSize:2,bevelSegments:5}),o=new m.h({color:0});this.textMesh=new m.g(n,o),this.textMesh.position.set(250-this.progressLength,this.yPos+25,0),this.textMesh.rotation.set(0,0,Math.PI),e.add(this.textMesh)},this.showTitle=function(){var t=new m.k("Progress Bar:",{font:a,size:10,height:5,curveSegments:12,bevelEnabled:!1,bevelThickness:1,bevelSize:2,bevelSegments:5}),n=new m.h({color:0});this.titleTextMesh=new m.g(t,n),this.titleTextMesh.position.set(350,this.yPos+7,0),this.titleTextMesh.rotation.set(0,0,Math.PI),e.add(this.titleTextMesh)},this.moveText=function(t,e){var a=(new m.b).setFromObject(this.textMesh);this.textMesh.position.set(t+.5*(a.max.x-a.min.x),e,0)},this.withinBar=function(t,e){return e<this.yPos+10&&e>this.yPos-10&&t<250&&t>-250},this.getStep=function(t){var e=250-t;return Math.round(e/this.stepLength)},this.setSteps=function(t){this.stepLength=500/t},this.getBar=function(){return this.progress.mesh}},b=function t(e,n){Object(h.a)(this,t);var o=a(68);this.arrowInfo=e,this.arrowInfo.dataIndex=void 0!==e.dataIndex?e.dataIndex:n;var i=e.dataPointRadius/40*22,s=e.dataPointRadius/40*15;this.textPullForward=-5,this.calculateLength=function(){var t=Math.sqrt((this.arrowInfo.point2.x-this.arrowInfo.point1.x)*(this.arrowInfo.point2.x-this.arrowInfo.point1.x)+(this.arrowInfo.point2.y-this.arrowInfo.point1.y)*(this.arrowInfo.point2.y-this.arrowInfo.point1.y));return t-=3*this.arrowInfo.dataPointRadius},this.calculateDir=function(){return new m.l(this.arrowInfo.point2.x-this.arrowInfo.point1.x,this.arrowInfo.point2.y-this.arrowInfo.point1.y,0)},this.calculatePos=function(){var t=new m.l(1.5*e.dataPointRadius*this.dir.x,1.5*e.dataPointRadius*this.dir.y,0),a=e.dataPointRadius/3.5;return e.shift&&(this.dir.x-this.dir.y>=0?this.dir.y<=-.5?t.x+=a:t.y+=a:this.dir.y>=.5?t.x+=a:t.y+=a),new m.l(this.arrowInfo.point1.x+t.x,this.arrowInfo.point1.y+t.y,0)},this.baseColor="#222222",this.object={},this.dir=this.calculateDir(),this.dir.normalize(),this.length=this.calculateLength(),this.position=this.calculatePos(),this.object=new m.a(this.dir,this.position,this.length,this.baseColor,i,s),this.lightenColor=function(t){var e=o(this.baseColor).lighten(t).toString();this.object=new m.a(this.dir,this.position,this.length,e,i,s)},this.darkenColor=function(t){var e=o(this.baseColor).darken(t).toString();this.object=new m.a(this.dir,this.position,this.length,e,i,s)},this.updatePos=function(t,e){this.arrowInfo.point1=t,this.arrowInfo.point2=e,this.dir=this.calculateDir(),this.dir.normalize(),this.length=this.calculateLength(),this.position=this.calculatePos(),this.object.setLength(this.length,i,s),this.object.setDirection(this.dir),this.object.position.set(this.position.x,this.position.y,0)},this.setLength=function(t){this.object.setLength(t)},this.delete=function(){this.scene.remove(this.object)},this.adjustScale=function(t){e.dataPointRadius=t,i=e.dataPointRadius/40*22,s=e.dataPointRadius/40*15,this.updatePos(this.arrowInfo.point1,this.arrowInfo.point2)},this.showIndex=function(t){var e=new m.k(this.arrowInfo.dataIndex.toString(),{font:t,size:10,height:5,curveSegments:12,bevelEnabled:!1,bevelThickness:1,bevelSize:2,bevelSegments:5}),a=new m.h({color:8421504});this.indexTextMesh=new m.g(e,a),this.moveIndexText(this.position.x,this.position.y),this.indexTextMesh.rotation.set(0,0,Math.PI)},this.changeIndexTextSize=function(t){var e=t/this.origLength;e=0===e?e=1e-4:e,this.indexTextMesh.scale.set(e,e,e+this.textPullForward)},this.moveIndexText=function(t,e){var a=(new m.b).setFromObject(this.indexTextMesh);this.indexTextMesh.position.set(t+.5*(a.max.x-a.min.x),e,this.textPullForward)}},y=function(t,e){var a=new w,n=new m.l(0,0,0),o={width:t.width,height:t.height},i=40,s=!0,r=1;e.color=e.color||[70,156,150,1],e.stepDelay=e.stepDelay||300,e.valueMax=e.valueMax||1,e.fluxMax=e.fluxMax||1,e.skipSteps=e.skipSteps||1,e.radius=e.radius||i;var h,d,u,p=e.valueMax/2,f=e.fluxMax/2,y=[170,0,255,1],P=e.radius||i,j=!1,k=-1,C=-1,M=0,S=[],I={size:P,valueMax:e.valueMax,fluxMax:e.fluxMax,stepDelay:e.stepDelay,color:e.color,skipSteps:e.skipSteps,generateCompartments:function(){!function(){if(null==e.animationData)return void alert("Compartment data must be uploaded first");if(e.dataPoints.length>0)return void alert("Compartments already exist");for(var a=t.getBoundingClientRect(),n=(a.width-e.animationData[0].length*(2*P)-2*P)/(e.animationData[0].length-1),o=0;o<e.animationData[0].length;o++){var i=-(a.width/2-P)+o*P*2+o*n+P,s=e.labels[o+1]?e.labels[o+1]:(o+1).toString();V(s),e.dataPoints[o].setPosition(-i,-1,0),e.dataPoints[o].moveText(-i,0),I.showIndices&&e.dataPoints[o].moveIndexText(-i,.75*e.dataPoints[k].radius)}}()},seekHelp:function(){window.open(window.location.href+"help.html","_blank")},changeStep:function(){B(!0)},startAnimation:function(){B()},pauseAnimation:function(){s=!0},resetAnimation:function(){e.animationData&&(e.step=0,s=!0,h.updateProgress(0,e.animationData[0][0]),G())},addPoint:function(){d&&function(){var t,a=e.labels,n=e.labelMode,o=e.dataPoints;t=n&&a.length>o.length+1?a[o.length+1]:n&&a.length<=o.length?window.prompt("Imported data does not contain a column #"+o.length+".\nPlease label your data point: "):window.prompt("Label your data point: ");if(!t||""===t)return void alert("No label entered");V(t)}()},addArrow:function(){d&&(M=1)},deletePoint:function(){d&&function(){C>-1&&(t=e.dataPoints[C],O.remove(t.object.mesh),O.remove(t.shadow.mesh),O.remove(t.textMesh),e.dataPoints.splice(C,1));var t;W(C)}()},showIndices:!1,compIndex:"",label:"",editMode:!1,labelMode:!1};(new m.f).load("https://threejs.org//examples/fonts/helvetiker_regular.typeface.json",L);var O=function(){t.addEventListener("mousedown",function(e){j=!0,N(t,e)}),t.addEventListener("mouseup",function(n){d&&(1===M&&(M=2,N(t,n),null!=S[0]&&null!=S[1]?function(){for(var t=e.arrows,n=!1,o=0;o<t.length;o++){if(t[o].arrowInfo.pointIndex1===S[0]&&t[o].arrowInfo.pointIndex2===S[1])return;t[o].arrowInfo.pointIndex1===S[1]&&t[o].arrowInfo.pointIndex2===S[0]&&(n=!0)}var i={shift:n,len:200,pointIndex1:S[0],pointIndex2:S[1],point1:e.dataPoints[S[0]].position,point2:e.dataPoints[S[1]].position,dataPointRadius:P,dataIndex:e.arrows.length+1},s=new b(i);a.add(s.object),I.showIndices&&(s.showIndex(u),a.add(s.indexTextMesh)),M=0,t.push(s)}():alert("Dragged line was not between two data points"),S[0]=null,S[1]=null),j=!1,k=-1),e.arrows.length>0&&W(-1)}),t.addEventListener("mousemove",function(a){if(d&&j){var n=A(t,a),o=z(n);k>-1&&(e.dataPoints[k].setPosition(o.x,o.y,0),e.dataPoints[k].moveText(o.x,o.y),I.showIndices&&e.dataPoints[k].moveIndexText(o.x,o.y+.75*e.dataPoints[k].radius))}});var a=new m.j;return a.background=new m.e("#FFF"),a}(),T=function(e){var a=e.width,n=e.height,o=new m.m({canvas:t,antialias:!0,alpha:!0}),i=window.devicePixelRatio?window.devicePixelRatio:1;return o.setPixelRatio(i),o.setSize(a,n),o.gammaInput=!0,o.gammaOutput=!0,o}(o),E=function(t){var e=t.width,a=t.height,o=new m.i(e/-2,e/2,a/-2,a/2,1,1e3);return o.position.set(0,0,-10),o.lookAt(n),o}(o),D=function(){var t=new x.a({autoPlace:!1});return document.getElementById("datGuiAnchor").appendChild(t.domElement),t.domElement.id="datGuiAnchor",t.add(I,"seekHelp").name("Help"),n=t.addFolder("Animation"),n.add(I,"changeStep").name("Step - -- -- -| \u21e5"),n.add(I,"startAnimation").name("Start - -- -- -| \u25b6"),n.add(I,"pauseAnimation").name("Pause - -- -| \u23f8"),n.add(I,"resetAnimation").name("Reset - --- -| \u21bb"),n.add(I,"stepDelay").name("Delay (in ms)").min(0).max(500).step(10).onChange(function(t){e.stepDelay=t}),n.add(I,"skipSteps").name("Step Size").onChange(function(t){e.skipSteps=t}),a=t.addFolder("Model Editing"),a.add(I,"generateCompartments").name("Generate Comps."),a.add(I,"editMode").name("Edit Mode").onChange(function(t){d=t}),a.add(I,"labelMode").name("Import Labels").onChange(function(t){e.labelMode=t}),a.add(I,"showIndices").name("Show Indices").onChange(function(t){!function(t){if(t){for(var a=0;a<e.dataPoints.length;a++)e.dataPoints[a].showIndex(u),O.add(e.dataPoints[a].indexTextMesh);for(var n=0;n<e.arrows.length;n++)e.arrows[n].showIndex(u),O.add(e.arrows[n].indexTextMesh)}else{for(var o=0;o<e.dataPoints.length;o++)O.remove(e.dataPoints[o].indexTextMesh);for(var i=0;i<e.arrows.length;i++)O.remove(e.arrows[i].indexTextMesh)}}(t)}),a.add(I,"compIndex").name("Data Index").listen().onFinishChange(function(t){-1!==C&&(t>e.dataPoints.length||t<1?alert("Invalid Index"):(e.dataPoints[C].dataIndex=t,O.remove(e.dataPoints[C].indexTextMesh),I.showIndices&&(e.dataPoints[C].showIndex(u),O.add(e.dataPoints[C].indexTextMesh))))}),a.add(I,"label").name("Comp. Label").listen().onFinishChange(function(t){O.remove(e.dataPoints[C].textMesh),e.dataPoints[C].appendText(u,t,e.dataPoints[C].position.x,e.dataPoints[C].position.y),O.add(e.dataPoints[C].textMesh)}),a.add(I,"addPoint").name("Add Compartment"),a.add(I,"addArrow").name("Add Arrow"),a.add(I,"deletePoint").name("Delete Compartment"),a.add(I,"size").name("Size").min(10).max(100).step(1).onChange(function(t){P=t,e.radius=P,function(){for(var t,a=0;a<e.dataPoints.length;a++)(t=e.dataPoints[a]).adjustScale(P),t.changeTextSize(P),t.moveText(t.object.mesh.position.x,t.object.mesh.position.y);for(var n=0;n<e.arrows.length;n++)e.arrows[n].adjustScale(P)}()}),function(t){t.add(I,"valueMax").name("Comp. Maximum").onChange(function(t){e.valueMax=t,p=e.valueMax/2}),t.add(I,"fluxMax").name("Flux Maximum").onChange(function(t){e.fluxMax=t,f=e.fluxMax/2}),t.addColor(I,"color").name("50% Max Color").onChange(function(t){!function(t){e.color=t;for(var a=0;a<e.dataPoints.length;a++)e.dataPoints[a].changeColor(t)}(y=t)})}(t.addFolder("Interpretation")),t;var a;var n}();function L(t){u=t,F()}function F(){!function(){var t=[];O.traverse(function(e){(e instanceof m.g||e instanceof m.a)&&t.push(e)});for(var e=0;e<t.length;e++)O.remove(t[e])}(),function(){var t=[],a=0;e.dataPoints.forEach(function(e){e.dataIndex||(e.dataIndex=a++);var n=function(t){var e=new v(t.dataIndex,t);O.add(e.object.mesh),O.add(e.shadow.mesh);var a=t.textMesh?t.textMesh.geometries[0].text:" ";a||(a=" ");return e.appendText(u,a,e.position.x,e.position.y),O.add(e.textMesh),e}(e);t.push(n),n.moveText(n.object.mesh.position.x,n.object.mesh.position.y)}),e.dataPoints=t}(),function(){var t=[],a=0;e.arrows.forEach(function(e){t.push(function(t,e){var a=new b(t.arrowInfo,e);return O.add(a.object),a}(e,a++))}),e.arrows=t}(),function(){var e=t.getBoundingClientRect();(h=new g(O,u,-e.height/2+25)).appendText("0"),h.showTitle()}(),e.skipSteps=e.skipSteps||1,e.stepDelay=e.stepDelay||300,e.valueMax=e.valueMax||1,e.fluxMax=e.fluxMax||1,e.color=e.color||[70,156,150,1],e.radius=e.radius||i,P=e.radius,p=e.valueMax/2,f=e.fluxMax/2,I.size=e.radius,I.skipSteps=e.skipSteps,I.valueMax=e.valueMax,I.fluxMax=e.fluxMax,I.stepDelay=e.stepDelay,I.color=e.color,D.updateDisplay()}function N(t,a){var n=z(A(t,a));if(I.compIndex="",I.label="",d)for(var o=0;o<e.dataPoints.length;o++){var i=e.dataPoints[o].withinCircle(n.x,n.y);if(i&&1===M)e.dataPoints[o].shadow.mesh.material.color.set("#ffff00"),S[0]=o;else if(i&&2===M)e.dataPoints[o].shadow.mesh.material.color.set("#ffff00"),S[1]=o;else{if(i){-1!==C&&e.dataPoints[C].shadow.mesh.material.color.set("#cccccc"),e.dataPoints[o].shadow.mesh.material.color.set("#ffff00"),k=o,I.compIndex=e.dataPoints[o].dataIndex,I.label=e.dataPoints[o].labelText,C=o;break}e.dataPoints[o].shadow.mesh.material.color.set("#cccccc")}}if(-1===k&&h){if(C=-1,e.animationData&&!R())return void alert("Please import data first");if(h.withinBar(n.x,n.y)&&e.animationData){var s=h.getStep(n.x),r=e.animationData[s-1];h.updateProgress(s,r?r[0]:"0"),e.step=s-1,G()}}}function A(t,e){var a=t.getBoundingClientRect();return{x:e.clientX-a.left,y:e.clientY-a.top}}function z(e){var a=t.getBoundingClientRect();return{x:a.width/2-e.x,y:e.y-a.height/2}}function R(){return e&&!e.dataLoaded()&&alert("Please import data first"),e.dataLoaded()}function B(){return U.apply(this,arguments)}function U(){return(U=Object(c.a)(l.a.mark(function t(){var e,a=arguments;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=a.length>0&&void 0!==a[0]&&a[0],R()&&(s=!1,_(e));case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}function _(){return X.apply(this,arguments)}function X(){return(X=Object(c.a)(l.a.mark(function t(){var n,o=arguments;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.length>0&&void 0!==o[0]&&o[0],!e.hasNextStep()){t.next=8;break}if(s){t.next=8;break}return G(),e.step+=r,t.next=7,a.sleep(e.stepDelay);case 7:n||_();case 8:case"end":return t.stop()}},t)}))).apply(this,arguments)}function G(){var t=e.step<0?"0":e.animationData[e.step][0];e.step>=0&&function(){for(var t,a,n=0;n<e.dataPoints.length;n++)e.animationData[e.step][e.dataPoints[n].dataIndex]>p?(a=e.animationData[e.step][e.dataPoints[n].dataIndex]-p,t=a/p,e.dataPoints[n].darkenColor(50*t)):(a=p-e.animationData[e.step][e.dataPoints[n].dataIndex],t=a/p,e.dataPoints[n].lightenColor(50*t));if(null!=e.fluxData)for(var o=0;o<e.arrows.length-1;o++)e.fluxData[e.step][e.arrows[o].arrowInfo.dataIndex]>f?(a=e.fluxData[e.step][e.arrows[o].arrowInfo.dataIndex]-f,t=a/f,O.remove(e.arrows[o].object),e.arrows[o].darkenColor(50*t),O.add(e.arrows[o].object)):(a=f-e.fluxData[e.step][e.arrows[o].arrowInfo.dataIndex],t=a/f,O.remove(e.arrows[o].object),e.arrows[o].lightenColor(50*t),O.add(e.arrows[o].object))}(),h.updateProgress(e.step+1,t)}function V(t){var a=e.dataPoints,n=new v(a.length+1);O.add(n.object.mesh),O.add(n.shadow.mesh),I.showIndices&&(n.showIndex(u),O.add(n.indexTextMesh)),n.changeColor(y),n.adjustScale(P),n.appendText(u,t,n.position.x,n.position.y),O.add(n.textMesh),a.push(n),n.setPosition(0,0,0),n.moveText(0,0)}function W(t){for(var a=e.arrows,n=0;n<a.length;n++){var o=a[n].arrowInfo.pointIndex1,i=a[n].arrowInfo.pointIndex2;o===t||i===t?(O.remove(a[n].object),a.splice(n,1),n--):(o>t&&-1!==t&&(o--,a[n].arrowInfo.pointIndex1--),i>t&&-1!==t&&(i--,a[n].arrowInfo.pointIndex2--),a[n].updatePos(e.dataPoints[o].position,e.dataPoints[i].position),I.showIndices&&a[n].moveIndexText(a[n].position.x,a[n].position.y))}}return e.onFluxLoad=function(){},e.onLoad=function(){null!=e.animationData&&(h.appendText(e.animationData[0][0]),h.setSteps(e.animationData.length))},e.registerCallback(F),{update:function(){T.render(O,E)}}},P=function(t){function e(t){var a;return Object(h.a)(this,e),(a=Object(u.a)(this,Object(p.a)(e).call(this,t))).dataContext=a.props.dataContext,a}return Object(f.a)(e,t),Object(d.a)(e,[{key:"componentDidMount",value:function(){!function(t,e){var a=function(t,e){var a=t.createElement("canvas");return a.width=e.scrollWidth,a.height=e.scrollHeight,e.appendChild(a),a}(document,t),n=new y(a,e);!function t(){requestAnimationFrame(t),n.update()}()}(this.threeRootElement,this.dataContext)}},{key:"render",value:function(){var t=this;return o.a.createElement("div",{className:"canvas",ref:function(e){return t.threeRootElement=e}}," ")}}]),e}(n.Component),j=a(3),k=a(44),C=a.n(k),M=a(42),S=a.n(M),I=a(43),O=a.n(I),T=a(93),E=a.n(T),D=a(94),L=a.n(D),F=function(){function t(){Object(h.a)(this,t)}return Object(d.a)(t,[{key:"processXLSXIntoCSV",value:function(t,e){var a=this,n=new FileReader;n.readAsBinaryString(t),n.onload=function(){var t=a.transformXLXSIntoCsvStrings(n.result);e(a.parseSingleCSV(t[0]))}}},{key:"processPlotsData",value:function(t,e){var a=new FileReader;a.readAsText(t),a.onload=function(){var t=a.result;e(JSON.parse(t))}}},{key:"transformXLXSIntoCsvStrings",value:function(t){var e=a(179),n=[],o=e.read(t,{type:"binary"});return o.SheetNames.forEach(function(t){n.push(e.utils.sheet_to_csv(o.Sheets[t]))}),n}},{key:"parseSingleCSV",value:function(t){var e,a,n=0,o=1;for(a=0;a<t.length;a++)"\n"===(e=t.charAt(a))&&n++;for(e="",a=0;"\n"!==e;)","===(e=t.charAt(a))&&o++,a++;for(this.data=new Array(n),a=0;a<n;a++)this.data[a]=new Array(o);for(a=0;a<this.data.length;a++){var i=t.split("\n");this.data[a]=i[a].split(",")}for(a=1;a<this.data.length;a++)"t"!==this.data[a][0]&&"-"!==this.data[a][1]||this.data.splice(a,1);return this.data}}]),t}(),N=a(95),A=function(t){function e(t){var a;return Object(h.a)(this,e),(a=Object(u.a)(this,Object(p.a)(e).call(this,t))).title=a.props.title||"Upload file",a.processUpload=a.processUpload.bind(Object(j.a)(Object(j.a)(a))),a.state={callback:a.props.onDone,accept:a.props.accept,plot:a.props.isPlot},a}return Object(f.a)(e,t),Object(d.a)(e,[{key:"hasNoFiles",value:function(t){return 0===t.length}},{key:"processUpload",value:function(t){this.state.plot?this.readPlots(t.target.files,this.state.callback):this.readXLSX(t.target.files,this.state.callback)}},{key:"readPlots",value:function(t,e){var a=e,n=new F;0!==t.length&&n.processPlotsData(t[0],function(t){a(t)})}},{key:"readXLSX",value:function(t,e){var a=e,n=new F;this.hasNoFiles(t)||n.processXLSXIntoCSV(t[0],function(t){a(t)})}},{key:"render",value:function(){var t=this;return o.a.createElement(S.a,null,o.a.createElement(O.a,{htmlFor:this.title,style:{cursor:"pointer"}},this.title,o.a.createElement(L.a,{id:this.title,type:"file",accept:this.accept,onChange:this.processUpload,ref:function(e){t.fileInput=e},style:{display:"none"}})))}}]),e}(a.n(N).a),z=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"untracked";Object(h.a)(this,t),this.id=e,this.dataPoints=[],this.labels=[],this.arrows=[],this.step=0,this.fluxMax=1,this.valueMax=1,this.stepDelay=300,this.radius=40,this.color=[70,156,150,1],this.skipSteps=1},R=a(64),B=a.n(R),U=function(){function t(){Object(h.a)(this,t)}return Object(d.a)(t,[{key:"addNewModelToLocal",value:function(){var t=Object(c.a)(l.a.mark(function t(e){var a,n;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=this.newModelTemplate(e),t.next=3,this.loadModelsFromDefaultContainer();case 3:return(n=t.sent).push(a),t.next=7,this.saveToStore("plots",n,"Failed to add a new model").catch(function(){return a});case 7:return t.abrupt("return",a);case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"saveToStore",value:function(){var t=Object(c.a)(l.a.mark(function t(e,a){var n,o=arguments;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:"Failed to write to storage",t.prev=1,t.next=4,B.a.setItem(e,"!"+JSON.stringify(a));case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),alert(n+String(t.t0));case 9:case"end":return t.stop()}},t,null,[[1,6]])}));return function(e,a){return t.apply(this,arguments)}}()},{key:"fetchFromStore",value:function(){var t=Object(c.a)(l.a.mark(function t(e){var a,n,o=arguments;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:"Failed to fetch from storage",t.prev=1,t.next=4,B.a.getItem(e);case 4:if(n=t.sent){t.next=7;break}return t.abrupt("return",null);case 7:return t.abrupt("return",JSON.parse(n.substring(1)));case 10:t.prev=10,t.t0=t.catch(1),alert(a+": "+String(t.t0));case 13:case"end":return t.stop()}},t,null,[[1,10]])}));return function(e){return t.apply(this,arguments)}}()},{key:"updateStorage",value:function(){var t=Object(c.a)(l.a.mark(function t(e,a){var n,o,i,s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadModelsFromDefaultContainer();case 2:for(o in n=t.sent)n.hasOwnProperty(o)&&n[o].name===e&&(i=n[o],s=i.versions.length+1,a.id=e+s,i.versions=[this.newModelVersion(a)]);this.saveToStore("plots",n,"Failed to save the models");case 5:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}()},{key:"removeFromStorage",value:function(){var t=Object(c.a)(l.a.mark(function t(e){var a,n,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadModelsFromDefaultContainer();case 2:for(o in a=t.sent,n=[],a)a.hasOwnProperty(o)&&a[o].name!==e&&n.push(a[o]);this.saveToStore("plots",n,"Failed to save the models");case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"loadFromStorage",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadModelsFromDefaultContainer();case 2:return 0===(e=t.sent).length&&(e.push(this.newModelTemplate()),this.saveToStore("plots",e,"Failed to save the models")),t.abrupt("return",e);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"loadModelsFromDefaultContainer",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchFromStore("plots","Failed to Access Memory").catch();case 2:return(e=t.sent)&&e.length||(e=[]),t.abrupt("return",e);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"writeToLocalStorage",value:function(){var t=Object(c.a)(l.a.mark(function t(e){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e&&e.length||(e=[]),t.next=3,this.saveToStore("plots",e);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"newModelTemplate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Default Storage";return{name:t,versions:[this.newModelVersion(new z(t+".1"))]}}},{key:"newModelVersion",value:function(t){return{plot:t}}}]),t}(),_=(a(187),a(15)),X=function(t){function e(t){var a;return Object(h.a)(this,e),(a=Object(u.a)(this,Object(p.a)(e).call(this,t))).IController=a.props.IController,a.dataContext=a.props.dataContext,a.uploadPoints=a.uploadDataPoints.bind(Object(j.a)(Object(j.a)(a))),a.uploadFlux=a.uploadFluxData.bind(Object(j.a)(Object(j.a)(a))),a.processUpload=a.processUpload.bind(Object(j.a)(Object(j.a)(a))),a}return Object(f.a)(e,t),Object(d.a)(e,[{key:"downloadLocalStorage",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e,a,n,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Object(_.toast)("Prepping Download",{position:_.toast.POSITION.TOP_LEFT}),t.t0=JSON,t.next=4,(new U).loadModelsFromDefaultContainer();case 4:t.t1=t.sent,e=t.t0.stringify.call(t.t0,t.t1),a=new Blob([e],{type:"text/plain"}),n=window.URL.createObjectURL(a),(o=document.createElement("a")).setAttribute("href",n),o.setAttribute("download","plots.json"),document.body.appendChild(o),o.click(),o.remove();case 14:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()},{key:"processUpload",value:function(t){this.readPlots(t.target.files)}},{key:"uploadDataPoints",value:function(t){Object(_.toast)("Upload Point Data Complete",{position:_.toast.POSITION.TOP_LEFT}),this.dataContext.injectDataPointList(t)}},{key:"uploadFluxData",value:function(t){Object(_.toast)("Upload Flux Data Complete",{position:_.toast.POSITION.TOP_LEFT}),this.dataContext.injectFluxList(t)}},{key:"uploadModels",value:function(){var t=Object(c.a)(l.a.mark(function t(e){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e||!window.confirm("Warning! This will replace all of your models with the uploaded models. Continue?")){t.next=5;break}return t.next=3,(new U).writeToLocalStorage(e);case 3:return window.location.reload(),t.abrupt("return");case 5:Object(_.toast)("No Models Uploaded",{position:_.toast.POSITION.TOP_LEFT});case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=function(t){t.preventDefault()};return o.a.createElement(C.a,{inverse:!0,id:"mainNav"},o.a.createElement(C.a.Header,null,o.a.createElement(C.a.Brand,{className:"nav-brand"},o.a.createElement("a",{href:"https://github.com/staujd02/time_machine"},"Compartmental Visualizer"))),o.a.createElement(E.a,{inline:!0},o.a.createElement(A,{className:"nav-item",onDone:this.uploadPoints,isPlot:!1,accept:".xlsx",onClick:t,title:"Upload Compartment Data"}),o.a.createElement(A,{className:"nav-item",onDone:this.uploadFlux,isPlot:!1,accept:".xlsx",onClick:t,title:"Upload Flux Data"}),o.a.createElement(A,{className:"nav-item",onDone:this.uploadModels,isPlot:!0,accept:".json",onClick:t,title:"Upload Models"}),o.a.createElement(S.a,{className:"nav-item"},o.a.createElement(O.a,{htmlFor:"Export Models",style:{cursor:"pointer"},onClick:this.downloadLocalStorage},"Export Models",o.a.createElement(_.ToastContainer,{autoClose:1500})))))}}]),e}(n.Component),G=function(t){function e(t){var a;return Object(h.a)(this,e),(a=Object(u.a)(this,Object(p.a)(e).call(this,t))).dataCapsule=a.props.dataCapsule,a.name=a.dataCapsule.name,a.className=a.props.className,a}return Object(f.a)(e,t),Object(d.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:this.className},this.name)}}]),e}(n.Component),V=a(45),W=a.n(V),H=function(t){function e(t){var a;Object(h.a)(this,e),a=Object(u.a)(this,Object(p.a)(e).call(this,t));var n=Object(j.a)(Object(j.a)(a));return a.entries=[],a.handleClick=a.handleClick.bind(Object(j.a)(Object(j.a)(a))),a.addToLocal=a.addToLocal.bind(Object(j.a)(Object(j.a)(a))),a.removeFromLocal=a.removeFromLocal.bind(Object(j.a)(Object(j.a)(a))),a.loadSaves=a.loadSaves.bind(Object(j.a)(Object(j.a)(a))),a.createButtonEntry=a.createButtonEntry.bind(Object(j.a)(Object(j.a)(a))),a.createEntryName=a.createEntryName.bind(Object(j.a)(Object(j.a)(a))),a.createGrid=a.createGrid.bind(Object(j.a)(Object(j.a)(a))),a.activeModelName=a.activeModelName.bind(Object(j.a)(Object(j.a)(a))),a.state={dataContext:n.props.dataContext},a.loadSaves(),a}return Object(f.a)(e,t),Object(d.a)(e,[{key:"isActive",value:function(t){return this.state.dataContext.currentPlot().id===t.versions[t.versions.length-1].plot.id}},{key:"applyName",value:function(t){return this.isActive(t)?"Save":"Load"}},{key:"createButtonEntry",value:function(t){var e=this;return o.a.createElement(W.a,{key:this.entries.length,className:"grid-item",onClick:function(){return e.handleClick(t)}},this.applyName(t))}},{key:"createEntryName",value:function(t){return o.a.createElement(G,{key:this.entries.length,className:"grid-item",dataCapsule:t})}},{key:"activeModelName",value:function(){var t=this,e="";return this.state.models&&this.state.models.forEach(function(a){t.isActive(a)&&(e=a.name)})," "+e}},{key:"addToLocal",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.solictStorageName("you would like to add."))){t.next=7;break}return t.next=4,(new U).addNewModelToLocal(e);case 4:return t.next=6,this.loadSaves();case 6:this.forceUpdate();case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"removeFromLocal",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.solictStorageName("you would like to permanently delete."))){t.next=8;break}return t.next=4,(new U).removeFromStorage(e);case 4:return t.next=6,this.loadSaves();case 6:this.forceUpdate(),_.toast.success("Model Removed");case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"solictStorageName",value:function(t){return window.prompt("Please enter the name of Model "+t)}},{key:"handleClick",value:function(){var t=Object(c.a)(l.a.mark(function t(e){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isActive(e)){t.next=7;break}return a=this.state.dataContext.currentPlot(),t.next=4,(new U).updateStorage(e.name,a);case 4:_.toast.success("Model Saved"),t.next=11;break;case 7:return t.next=9,this.loadSaves();case 9:this.state.dataContext.currentPlot(e),this.forceUpdate();case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"loadSaves",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e,a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.entries=[],t.next=3,(new U).loadFromStorage(this.ThreeController);case 3:e=t.sent,a=this.state.dataContext,this.setState({dataContext:a,models:e});case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"createGrid",value:function(){var t=this;this.state.models&&(this.entries=[],this.state.models.forEach(function(e){t.entries.push(t.createEntryName(e)),t.entries.push(t.createButtonEntry(e))}))}},{key:"render",value:function(){return this.createGrid(),o.a.createElement("div",null,o.a.createElement("h4",{className:"model-list-banner"},"Models"),o.a.createElement("h5",{className:"active-banner"},o.a.createElement("span",null,"Loaded Model: "),this.activeModelName()),o.a.createElement("div",{className:"grid-container"},this.entries),o.a.createElement("div",{className:"grid-container"},o.a.createElement(W.a,{id:"new-plot",onClick:this.addToLocal},"New Model"),o.a.createElement(W.a,{id:"delete-plot",onClick:this.removeFromLocal},"Delete Model")))}}]),e}(n.Component),J=a(63),q=a.n(J),Q=a(36),Y=a.n(Q),$=a(65),K=a.n($),Z=a(96),tt=a.n(Z),et=function(t){var e={};return e.plot_id=t.id,e.callbacks=[],e.labelMode=!1,e.onLoad=null,e.animationData=null,e.fluxData=null,Object.assign(e,t),e.callObservers=function(){e.callbacks.forEach(function(t){t()})},e.registerCallback=function(t){e.callbacks.push(t)},e.currentPlot=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?e.loadPlot(t.versions[t.versions.length-1].plot):{id:e.plot_id,dataPoints:e.dataPoints,labels:e.labels,arrows:e.arrows,step:e.step,valueMax:e.valueMax,fluxMax:e.fluxMax,stepDelay:e.stepDelay,color:e.color,skipSteps:e.skipSteps,radius:e.radius}},e.loadPlot=function(t){return Object.assign(e,t),e.plot_id=t.id,e.callObservers(),t},e.injectDataPointList=function(t){return a=t,(n=e).labels=a[0],a.splice(0,1),n.animationData=a,void(n.onLoad&&"function"===typeof n.onLoad&&n.onLoad());var a,n},e.injectFluxList=function(t){return n=e,(a=t).splice(0,1),n.fluxData=a,void(n.onLoad&&"function"===typeof n.onLoad&&n.onLoad());var a,n},e.dataLoaded=function(){return null!=e.animationData},e.hasNextStep=function(){return e.dataLoaded()&&e.step<e.animationData.length},e},at=function(t){function e(t){var a;return Object(h.a)(this,e),(a=Object(u.a)(this,Object(p.a)(e).call(this,t))).ThreeController={resetDataAnimation:function(){},onLoad:function(){},onFluxLoad:function(){}},a.fetchSaves(),a}return Object(f.a)(e,t),Object(d.a)(e,[{key:"fetchSaves",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e,a,n;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new U).loadFromStorage(this.ThreeController);case 2:e=t.sent,console.log(e),a=e[0].versions[e[0].versions.length-1].plot,n=new et(a),this.setState({saves:e,currentPlot:a,currentContext:n});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return this.state&&this.state.currentContext?o.a.createElement("div",{className:"app"},o.a.createElement(q.a,{fluid:!0,className:"fill"},o.a.createElement(Y.a,null,o.a.createElement(X,{dataContext:this.state.currentContext,IController:this.ThreeController})),o.a.createElement(Y.a,{className:"fill"},o.a.createElement(K.a,{sm:2,md:2,className:"sidebar"},o.a.createElement(Y.a,{sm:2,md:2},o.a.createElement("div",{className:"dat-style",id:"datGuiAnchor"})),o.a.createElement(Y.a,{sm:2,md:2},o.a.createElement(H,{dataContext:this.state.currentContext,saves:this.saves})),o.a.createElement(tt.a,{className:"logo",src:"./pfw-white.png"})),o.a.createElement(K.a,{sm:10,md:10,className:"threeContainer"},o.a.createElement(P,{dataContext:this.state.currentContext,IController:this.ThreeController}))))):o.a.createElement("div",null,"Loading From Storage")}}]),e}(n.Component),nt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ot(t){navigator.serviceWorker.register(t).then(function(t){t.onupdatefound=function(){var e=t.installing;e.onstatechange=function(){"installed"===e.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(t){console.error("Error during service worker registration:",t)})}s.a.render(o.a.createElement(at,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/time_machine",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/time_machine","/service-worker.js");nt?(function(t){fetch(t).then(function(e){404===e.status||-1===e.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(t){t.unregister().then(function(){window.location.reload()})}):ot(t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ot(t)})}}()},86:function(t,e){},97:function(t,e,a){t.exports=a(198)}},[[97,1,2]]]);
//# sourceMappingURL=main.54f21de5.chunk.js.map