{"version":3,"sources":["lib/threejs/DataPoint.js","lib/ActionUtilities.js","lib/threejs/ProgressBar.js","lib/threejs/FluxArrow.js","lib/threejs/SceneManager.js","components/ThreeContainer.js","lib/threejs/threeEntryPoint.js","lib/FileUtilities.js","components/FileInput.js","lib/threejs/PlotData.js","lib/LocalStorage.js","components/Navigation.js","components/SavedPlot.js","components/StorageList.js","lib/threejs/DataContext.js","App.js","registerServiceWorker.js","index.js"],"names":["DataPoint","index","previousState","arguments","length","undefined","Object","classCallCheck","this","tinycolor","require","isState","dataIndex","labelText","baseColor","radius","shadowMargin","shadowPushBack","textPullForward","shadow","geometry","THREE","mesh","material","color","object","position","set","scale","withinCircle","x","y","pos","Math","sqrt","adjustScale","newRadius","newScale","appendText","font","text","xpos","ypos","size","height","curveSegments","bevelEnabled","bevelThickness","bevelSize","bevelSegments","textMesh","moveText","rotation","PI","changeTextSize","newX","newY","box","setFromObject","max","min","moveIndexText","indexTextMesh","setPosition","z","changeIndexTextSize","transformColor","colorObject","r","g","b","toHexString","changeColor","toString","lightenColor","percent","lighten","darkenColor","darken","showIndex","update","ActionUtilities","ms","Promise","resolve","setTimeout","ProgressBar","scene","fontResource","yPos","stepLength","bar","progress","start","stop","progressLength","add","updateProgress","step","timeInfo","remove","withinBar","getStep","clickedPos","round","setSteps","numOfSteps","getBar","FluxArrow","arrowInfo","legacySaveIndex","arrowLength","dataPointRadius","arrowWidth","calculateLength","distance","point2","point1","calculateDir","calculatePos","adjust","dir","shiftAmount","shift","normalize","newColor","updatePos","to","from","setLength","setDirection","len","delete","origLength","SceneManager","canvas","data","actionUtil","origin","screenDimensions","width","origRadius","paused","stepInc","stepDelay","valueMax","fluxMax","skipSteps","progressBar","editMode","halfQuantity","halfFlux","mouseDown","dataPointToMove","dataPointToDelete","arrowMode","arrowPoints","controls","generateCompartments","animationData","alert","dataPoints","rect","getBoundingClientRect","spaceBetween","i","xPos","label","labels","addDataPoint","showIndices","seekHelp","window","open","changeStep","startStepping","startAnimation","pauseAnimation","resetAnimation","applyStep","addPoint","labelMode","prompt","addArrow","deletePoint","dataPoint","splice","updateArrows","deleteDataPoint","compIndex","load","fontLoadingComplete","addEventListener","evt","checkWithinRange","arrows","pointIndex1","pointIndex2","arrow","push","mousePos","getMousePos","newMousePos","canvasToThreePos","background","buildScene","renderer","_ref","antialias","alpha","DPR","devicePixelRatio","setPixelRatio","setSize","gammaInput","gammaOutput","buildRender","camera","_ref2","lookAt","buildCamera","datGui","gui","dat","autoPlace","document","getElementById","appendChild","domElement","id","name","folder","addFolder","onChange","newValue","editFolder","show","listen","onFinishChange","point","changeAllRadius","addColor","buildInterpretationFolder","buildGUI","reloadScene","traverse","child","clearScene","hydratedPoints","c","forEach","oldPoint","savedData","geometries","restoreDataPoint","reloadDataPoints","hydratedArrows","legacyArrowIndex","oldArrow","legacyIndex","restoreArrow","reloadArrows","buildProgressBar","updateDisplay","selected","isDataLoaded","clickedStep","clientX","left","clientY","top","dataLoaded","_startStepping","apply","asyncToGenerator","regenerator_default","a","mark","_callee","singleStep","_args","wrap","_context","prev","next","stepForward","_stepForward","_callee2","_args2","_context2","hasNextStep","sleep","changePercent","diff","fluxData","colorPoints","deletedDataPoint","index1","index2","onFluxLoad","onLoad","registerCallback","render","ThreeContainer","props","_this","possibleConstructorReturn","getPrototypeOf","call","dataContext","container","createElement","scrollWidth","scrollHeight","createCanvas","sceneManager","requestAnimationFrame","threeEntryPoint","threeRootElement","_this2","react_default","className","ref","element","Component","FileUtilities","xlsxFile","onComplete","reader","FileReader","readAsBinaryString","onload","csvSheetStrings","transformXLXSIntoCsvStrings","result","parseSingleCSV","file","readAsText","JSON","parse","binaryContents","XLSX","csvStrings","workbook","read","type","SheetNames","utils","sheet_to_csv","Sheets","csvString","ch","numOfRows","numOfColumns","charAt","Array","rows","split","FileInput","title","processUpload","bind","assertThisInitialized","state","callback","onDone","accept","plot","isPlot","files","e","readPlots","target","readXLSX","fileUtil","processPlotsData","dataString","hasNoFiles","processXLSXIntoCSV","FormGroup_default","ControlLabel_default","htmlFor","style","cursor","FormControl_default","input","fileInput","display","NavItem","PlotData","LocalStorage","modelName","model","newModelTemplate","loadModelsFromDefaultContainer","models","saveToStore","catch","key","value","failureMsg","localforage","setItem","stringify","String","t0","getItem","substring","_context3","addition","modelId","hasOwnProperty","versions","newModelVersion","reducedList","fetchFromStore","dataArray","Navigation","IController","uploadPoints","uploadDataPoints","uploadFlux","uploadFluxData","toast","POSITION","TOP_LEFT","localStorage","blobData","Blob","textFile","URL","createObjectURL","downloadAnchorNode","setAttribute","body","click","injectDataPointList","injectFluxList","confirm","writeToLocalStorage","location","reload","preventRedirect","preventDefault","Navbar_default","inverse","Header","Brand","href","Form_default","inline","FileInput_FileInput","onClick","uploadModels","downloadLocalStorage","lib","autoClose","Image_default","src","SavedPlot","param","dataCapsule","StorageList","parent","entries","handleClick","addToLocal","removeFromLocal","loadSaves","createButtonEntry","createEntryName","createGrid","activeModelName","capsule","currentPlot","isActive","save","Button_default","applyName","SavedPlot_SavedPlot","_this3","s","resp","solictStorageName","addNewModelToLocal","forceUpdate","removeFromStorage","success","extension","updateStorage","loadFromStorage","ThreeController","setState","_this4","DataContext","context","plot_id","callbacks","assign","callObservers","loadPlot","json","xlsxData","instance","App","resetDataAnimation","fetchSaves","saves","console","log","currentContext","Grid_default","fluid","Row_default","components_Navigation","Col_default","sm","md","StorageList_StorageList","ThreeContainer_ThreeContainer","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","error","ReactDOM","src_App","process","concat","fetch","response","status","headers","get","indexOf","ready","unregister","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.ee0df8d5.chunk.js","sourcesContent":["/* Imported From: https://itnext.io/how-to-use-plain-three-js-in-your-react-apps-417a79d926e0 */\r\nimport * as THREE from 'three'\r\n\r\nclass DataPoint {\r\n\r\n    constructor(index, previousState = null) {\r\n        var tinycolor = require('tinycolor2');\r\n        const origRadius = 40;\r\n\r\n        let isState = !!previousState;\r\n\r\n        this.dataIndex = index; // Holds the index the data point will retrieve data from\r\n        this.labelText = \"\";\r\n        this.baseColor = isState ? previousState.baseColor : \"#aa00ff\";\r\n        this.radius = origRadius;\r\n        this.shadowMargin = 7;\r\n        this.shadowMargin = isState ? previousState.shadowMargin : 7;\r\n        this.shadowPushBack = 1;\r\n        this.textPullForward = -5;\r\n\r\n        this.shadow = {};\r\n        this.shadow.geometry = new THREE.CircleGeometry(this.radius + this.shadowMargin, 32);\r\n        this.shadow.mesh = new THREE.Mesh(this.shadow.geometry);\r\n        this.shadow.mesh.material =\r\n            new THREE.MeshBasicMaterial({\r\n                color: \"#cccccc\"\r\n            });\r\n\r\n        this.object = {};\r\n        this.object.geometry = new THREE.CircleGeometry(this.radius, 32);\r\n        this.object.mesh = new THREE.Mesh(this.object.geometry);\r\n        this.object.mesh.material =\r\n            new THREE.MeshBasicMaterial({\r\n                color: this.baseColor\r\n            });\r\n\r\n        this.object.mesh.position.set(0, 0, 0);\r\n        this.shadow.mesh.position.set(0, 0, this.shadowPushBack);\r\n\r\n        this.position = this.object.mesh.position;\r\n        this.shadow.position = this.shadow.mesh.position;\r\n\r\n        this.object.scale = this.object.mesh.scale;\r\n        this.shadow.scale = this.shadow.mesh.scale;\r\n\r\n        this.withinCircle = function (x, y) {\r\n            let pos = this.object.mesh.position;\r\n            let distance = Math.sqrt((x - pos.x) * (x - pos.x) + (y - pos.y) * (y - pos.y));\r\n            return !(distance > this.radius);\r\n        };\r\n\r\n        this.adjustScale = function (newRadius) {\r\n            this.radius = newRadius;\r\n            let newScale = this.radius / origRadius;\r\n            this.object.scale.set(newScale, newScale, newScale);\r\n            this.shadow.scale.set(newScale, newScale, newScale);\r\n        };\r\n\r\n        this.appendText = function (font, text, xpos, ypos) {\r\n            this.labelText = text;\r\n            var geometry = new THREE.TextGeometry(text, {\r\n                font: font,\r\n                size: 13,\r\n                height: 5,\r\n                curveSegments: 12,\r\n                bevelEnabled: false,\r\n                bevelThickness: 1,\r\n                bevelSize: 2,\r\n                bevelSegments: 5\r\n            });\r\n            let material = new THREE.MeshBasicMaterial({\r\n                color: 0x000000\r\n            });\r\n            this.textMesh = new THREE.Mesh(geometry, material);\r\n            this.moveText(xpos, ypos);\r\n            this.textMesh.rotation.set(0, 0, Math.PI);\r\n            this.changeTextSize(this.radius);\r\n        };\r\n\r\n        this.moveText = function (newX, newY) {\r\n            var box = new THREE.Box3().setFromObject(this.textMesh); // To center text horizontally\r\n            this.textMesh.position.set(newX + .5 * (box.max.x - box.min.x), newY, this.textPullForward);\r\n        }\r\n\r\n        this.moveIndexText = function (newX, newY) {\r\n            var box = new THREE.Box3().setFromObject(this.indexTextMesh); // To center text horizontally\r\n            this.indexTextMesh.position.set(newX + .5 * (box.max.x - box.min.x), newY, this.textPullForward);\r\n        }\r\n\r\n        this.setPosition = function (x, y, z) {\r\n            this.position.set(x, y, z);\r\n            this.shadow.position.set(x, y, this.shadowPushBack);\r\n        }\r\n\r\n        this.changeTextSize = function (newScale) {\r\n            let scale = newScale / origRadius;\r\n            this.textMesh.scale.set(scale, scale, scale + this.textPullForward);\r\n        }\r\n        this.changeIndexTextSize = function (newScale) {\r\n            let scale = newScale / origRadius;\r\n            this.indexTextMesh.scale.set(scale, scale, scale + this.textPullForward);\r\n        }\r\n\r\n        this.transformColor = function (colorObject) {\r\n            return tinycolor({\r\n                r: colorObject[0],\r\n                g: colorObject[1],\r\n                b: colorObject[2]\r\n            }).toHexString();\r\n        }\r\n\r\n        this.changeColor = function (colorObject) {\r\n            this.baseColor = this.transformColor(colorObject);\r\n            this.object.mesh.material.color.set(this.baseColor.toString());\r\n        };\r\n\r\n        this.lightenColor = function (percent) {\r\n            this.object.mesh.material.color.set(tinycolor(this.baseColor).lighten(percent).toString());\r\n        };\r\n\r\n        this.darkenColor = function (percent) {\r\n            this.object.mesh.material.color.set(tinycolor(this.baseColor).darken(percent).toString());\r\n        };\r\n\r\n        this.showIndex = function (font) {\r\n            var geometry = new THREE.TextGeometry(this.dataIndex.toString(), {\r\n                font: font,\r\n                size: 10,\r\n                height: 5,\r\n                curveSegments: 12,\r\n                bevelEnabled: false,\r\n                bevelThickness: 1,  \r\n                bevelSize: 2,\r\n                bevelSegments: 5\r\n            });\r\n            let material = new THREE.MeshBasicMaterial({\r\n                color: 0x808080\r\n            });\r\n            this.indexTextMesh = new THREE.Mesh(geometry, material);\r\n            this.moveIndexText(this.position.x, this.position.y + (3/4)*(this.radius));\r\n            this.indexTextMesh.rotation.set(0, 0, Math.PI);\r\n            this.changeIndexTextSize(this.radius);\r\n        };\r\n\r\n        if (isState) {\r\n            this.adjustScale(previousState.radius);\r\n            this.object.mesh.position.set(previousState.position.x, previousState.position.y, previousState.position.z);\r\n            this.shadow.mesh.position.set(previousState.shadow.position.x, previousState.shadow.position.y, previousState.shadow.position.z);\r\n        }\r\n\r\n        this.update = function () {\r\n\r\n        };\r\n    };\r\n}\r\n\r\nexport default DataPoint;","export default class ActionUtilities  {\r\n\r\n    sleep(ms) {\r\n        return new Promise(resolve => setTimeout(resolve, ms));\r\n      }\r\n\r\n      \r\n}","import * as THREE from 'three'\r\n\r\nclass ProgressBar {\r\n\r\n    constructor(scene, fontResource, yPos) {\r\n        const barLength = 500;\r\n        this.stepLength = 0;\r\n        this.yPos = yPos;\r\n\r\n        this.bar = {};\r\n        this.progress = {};\r\n        this.start = {};\r\n        this.stop = {};\r\n\r\n        this.bar.geometry = new THREE.BoxGeometry( barLength, 20, 1 );\r\n        this.bar.mesh = new THREE.Mesh(this.bar.geometry);\r\n        this.bar.mesh.material = new THREE.MeshBasicMaterial( {color: \"#afafaf\"} );\r\n\r\n        this.progressLength = 0;\r\n        this.progress.geometry = new THREE.BoxGeometry( this.progressLength, 20, 1 );\r\n        this.progress.mesh = new THREE.Mesh( this.progress.geometry);\r\n        this.progress.mesh.material = new THREE.MeshBasicMaterial( {color: \"#666666\"} );\r\n        this.bar.mesh.position.set(0, this.yPos, 0);\r\n        this.progress.mesh.position.set((barLength-this.progressLength)/2, this.yPos, 0);//TODO: Make height to bottom of screen + padding\r\n        scene.add(this.bar.mesh);\r\n        scene.add(this.progress.mesh);\r\n\r\n        this.updateProgress = function(step, timeInfo){\r\n            if (this.stepLength * step <= barLength){\r\n                this.progressLength = this.stepLength * step;\r\n                this.progress.mesh.geometry = new THREE.BoxGeometry( this.progressLength, 20, 1 );\r\n                this.progress.mesh.position.set((barLength-this.progressLength)/2, this.yPos, 0);//TODO: Make height to bottom of screen + padding\r\n                this.appendText(timeInfo)\r\n            }\r\n        }\r\n\r\n        this.appendText = function (text) {\r\n            if(this.textMesh != null){\r\n                scene.remove(this.textMesh)\r\n            }\r\n            var geometry = new THREE.TextGeometry(text, {\r\n                font: fontResource,\r\n                size: 10,\r\n                height: 5,\r\n                curveSegments: 12,\r\n                bevelEnabled: false,\r\n                bevelThickness: 1,\r\n                bevelSize: 2,\r\n                bevelSegments: 5\r\n            });\r\n            let material = new THREE.MeshBasicMaterial({ color: 0x000000 });\r\n            this.textMesh = new THREE.Mesh(geometry, material);\r\n            this.textMesh.position.set(250 - this.progressLength, this.yPos + 25, 0);\r\n            this.textMesh.rotation.set(0, 0, Math.PI);\r\n            scene.add(this.textMesh);\r\n        };\r\n\r\n        this.moveText = function(newX, newY){\r\n            var box = new THREE.Box3().setFromObject( this.textMesh );//To center text horizontally\r\n            this.textMesh.position.set(newX + .5*(box.max.x - box.min.x), newY, 0);\r\n        }\r\n\r\n        this.withinBar = function (x, y) {\r\n            var withinHeight = (y < this.yPos + 10) && (y > this.yPos - 10)\r\n            var withinWidth = (x < 250) && ( x > -250)\r\n            return withinHeight && withinWidth\r\n        };\r\n\r\n        this.getStep = function (x) {\r\n            var clickedPos = 250 - x;\r\n            var step = Math.round(clickedPos/this.stepLength);\r\n            return step;\r\n        };\r\n\r\n       this.setSteps = function (numOfSteps){\r\n            this.stepLength = barLength/numOfSteps;\r\n        }\r\n\r\n        this.getBar = function (){\r\n            return this.progress.mesh\r\n        }\r\n    };\r\n}\r\n\r\nexport default ProgressBar; ","import * as THREE from 'three'\r\n\r\nclass FluxArrow {\r\n    constructor(arrowInfo, legacySaveIndex) {\r\n        var tinycolor = require('tinycolor2');\r\n        this.arrowInfo = arrowInfo;\r\n        this.arrowInfo.dataIndex = !!arrowInfo.dataIndex ? arrowInfo.dataIndex : legacySaveIndex; // Keep a defined value or fallback to legacy index\r\n        var arrowLength = 22 * (arrowInfo.dataPointRadius/40);\r\n        var arrowWidth = 15 * (arrowInfo.dataPointRadius/40); //Keep relative proportions liked with data points of radius 40 \r\n        this.textPullForward = -5;\r\n\r\n        this.calculateLength = function () {\r\n            //Length from center to center\r\n            let distance = Math.sqrt((this.arrowInfo.point2.x - this.arrowInfo.point1.x) * (this.arrowInfo.point2.x - this.arrowInfo.point1.x) +\r\n                (this.arrowInfo.point2.y - this.arrowInfo.point1.y) * (this.arrowInfo.point2.y - this.arrowInfo.point1.y));\r\n            //Moves each end to edge of circle plus 1/2 of radius more\r\n            distance = distance - 3 * (this.arrowInfo.dataPointRadius)\r\n            return distance;\r\n        };\r\n        this.calculateDir = function () {\r\n           return new THREE.Vector3(this.arrowInfo.point2.x - this.arrowInfo.point1.x, this.arrowInfo.point2.y - this.arrowInfo.point1.y, 0);\r\n        }\r\n        this.calculatePos = function () {\r\n            var adjust = new THREE.Vector3(1.5 * arrowInfo.dataPointRadius * this.dir.x, 1.5 * arrowInfo.dataPointRadius * this.dir.y, 0) //1.5 * 40 = To edge + 50% of circle radius\r\n            var shiftAmount = arrowInfo.dataPointRadius/3.5;\r\n            if (arrowInfo.shift){\r\n                var diff = (this.dir.x - this.dir.y)\r\n                if (diff >= 0){\r\n                    if (this.dir.y <= -.5) {\r\n                        adjust.x += shiftAmount;\r\n                    }else{\r\n                        adjust.y += shiftAmount;\r\n                    }\r\n                } else {\r\n                    if (this.dir.y >= .5) {\r\n                        adjust.x += shiftAmount;\r\n                    }else{\r\n                        adjust.y += shiftAmount;\r\n                    }\r\n                }\r\n            }\r\n            return new THREE.Vector3(this.arrowInfo.point1.x + adjust.x, this.arrowInfo.point1.y + adjust.y, 0)\r\n        }\r\n\r\n\r\n        this.baseColor = \"#222222\"\r\n        this.object = {};\r\n        this.dir = this.calculateDir();\r\n        this.dir.normalize();\r\n        this.length = this.calculateLength();\r\n        this.position = this.calculatePos();\r\n\r\n        this.object = new THREE.ArrowHelper(this.dir, this.position, this.length, this.baseColor, arrowLength, arrowWidth);\r\n\r\n        this.lightenColor = function (percent) {\r\n            var newColor = tinycolor(this.baseColor).lighten(percent).toString();\r\n            this.object = new THREE.ArrowHelper(this.dir, this.position, this.length, newColor, arrowLength, arrowWidth);\r\n        };\r\n\r\n        this.darkenColor = function (percent) {\r\n            var newColor = tinycolor(this.baseColor).darken(percent).toString();\r\n            this.object = new THREE.ArrowHelper(this.dir, this.position, this.length, newColor, arrowLength, arrowWidth);\r\n        };\r\n\r\n        this.updatePos = function (to, from) {\r\n            this.arrowInfo.point1 = to;\r\n            this.arrowInfo.point2 = from;\r\n\r\n            this.dir = this.calculateDir();\r\n            this.dir.normalize();\r\n            this.length = this.calculateLength();\r\n            this.position = this.calculatePos();\r\n\r\n            this.object.setLength(this.length, arrowLength, arrowWidth);\r\n            this.object.setDirection(this.dir);\r\n            this.object.position.set(this.position.x, this.position.y, 0);\r\n        };\r\n\r\n        this.setLength = function (len) {\r\n            this.object.setLength(len);\r\n        };\r\n\r\n        this.delete = function () {\r\n            this.scene.remove(this.object);\r\n        };\r\n\r\n        this.adjustScale = function (newRadius) {\r\n            arrowInfo.dataPointRadius = newRadius\r\n            arrowLength = 22 * (arrowInfo.dataPointRadius/40);\r\n            arrowWidth = 15 * (arrowInfo.dataPointRadius/40);\r\n            this.updatePos(this.arrowInfo.point1, this.arrowInfo.point2);\r\n        };\r\n\r\n        this.showIndex = function (font) {\r\n            var geometry = new THREE.TextGeometry(this.arrowInfo.dataIndex.toString(), {\r\n                font: font,\r\n                size: 10,\r\n                height: 5,\r\n                curveSegments: 12,\r\n                bevelEnabled: false,\r\n                bevelThickness: 1,  \r\n                bevelSize: 2,\r\n                bevelSegments: 5\r\n            });\r\n            let material = new THREE.MeshBasicMaterial({\r\n                color: 0x808080\r\n            });\r\n            this.indexTextMesh = new THREE.Mesh(geometry, material);\r\n            this.moveIndexText(this.position.x, this.position.y);\r\n            this.indexTextMesh.rotation.set(0, 0, Math.PI);\r\n           // this.changeIndexTextSize(this.length);\r\n        };\r\n\r\n        this.changeIndexTextSize = function (newScale) {\r\n            let scale = newScale / this.origLength;\r\n            this.indexTextMesh.scale.set(scale, scale, scale + this.textPullForward);\r\n        };\r\n\r\n        this.moveIndexText = function (newX, newY) {\r\n            var box = new THREE.Box3().setFromObject(this.indexTextMesh); // To center text horizontally\r\n            this.indexTextMesh.position.set(newX + .5 * (box.max.x - box.min.x), newY, this.textPullForward);\r\n        };\r\n    };\r\n}\r\n\r\nexport default FluxArrow","/* Imported From: https://itnext.io/how-to-use-plain-three-js-in-your-react-apps-417a79d926e0 */\r\nimport * as THREE from 'three';\r\nimport DataPoint from './DataPoint';\r\nimport * as dat from 'dat.gui';\r\nimport ActionUtilities from '../ActionUtilities';\r\nimport ProgressBar from './ProgressBar';\r\nimport FluxArrow from './FluxArrow';\r\n\r\nexport default (canvas, data) => {\r\n\r\n    const actionUtil = new ActionUtilities();\r\n\r\n    const origin = new THREE.Vector3(0, 0, 0);\r\n    const screenDimensions = {\r\n        width: canvas.width,\r\n        height: canvas.height\r\n    }\r\n    const origRadius = 40;\r\n\r\n    var paused = true;\r\n    var stepInc = 1;\r\n    data.color = data.color || [70, 156, 150, 1];\r\n    data.stepDelay = data.stepDelay || 300;\r\n    data.valueMax = data.valueMax || 1;\r\n    data.fluxMax = data.fluxMax || 1;\r\n    data.skipSteps = data.skipSteps || 1;\r\n    data.radius = data.radius || origRadius;\r\n    var halfQuantity = data.valueMax / 2.0;\r\n    var halfFlux = data.fluxMax / 2.0;\r\n    var baseColor = [170, 0, 255, 1];\r\n    var radius = data.radius || origRadius;\r\n\r\n    var mouseDown = false;\r\n    var dataPointToMove = -1;\r\n    var dataPointToDelete = -1;\r\n\r\n    var progressBar;\r\n    var editMode;\r\n    var arrowMode = 0; //0 = Off, 1 = Waiting for 1st point, 2 = Waiting for 2nd point\r\n    var arrowPoints = [] //After `Add Arrow`, [0] holds FROM data point's index, [1] holds TO data point's index\r\n\r\n    var fontResource;\r\n\r\n    const controls = {\r\n        size: radius,\r\n        valueMax: data.valueMax,\r\n        fluxMax: data.fluxMax,\r\n        stepDelay: data.stepDelay,\r\n        color: data.color,\r\n        skipSteps: data.skipSteps,\r\n        generateCompartments: function () {\r\n            generateCompartments();\r\n        },\r\n        seekHelp: function () {\r\n            window.open('/help.html', '_blank');\r\n        },\r\n        changeStep: function () {\r\n            startStepping(true);\r\n        },\r\n        startAnimation: function () {\r\n            startStepping();\r\n        },\r\n        pauseAnimation: function () {\r\n            paused = true;\r\n        },\r\n        resetAnimation: reset,\r\n        addPoint: function () {\r\n            if (editMode) {\r\n                addPoint();\r\n            }\r\n        },\r\n        addArrow: function () {\r\n            if (editMode) {\r\n                arrowMode = 1;\r\n            }\r\n        },\r\n        deletePoint: function () {\r\n            if (editMode) {\r\n                deleteDataPoint();\r\n            }\r\n        },\r\n        showIndices: false,\r\n        compIndex: \"\",\r\n        label: \"\",\r\n        editMode: false,\r\n        labelMode: false\r\n    }\r\n\r\n    loadFont();\r\n    const scene = buildScene();\r\n    const renderer = buildRender(screenDimensions);\r\n    const camera = buildCamera(screenDimensions);\r\n    var datGui = buildGUI();\r\n\r\n    function reset() {\r\n        if (data.animationData) {\r\n            data.step = 0;\r\n            paused = true;\r\n            progressBar.updateProgress(0, data.animationData[0][0]);\r\n            applyStep();\r\n        }\r\n    }\r\n\r\n    data.onFluxLoad = () => {}\r\n    data.onLoad = () => {\r\n        if (data.animationData != null) {\r\n            progressBar.appendText(data.animationData[0][0]);\r\n            progressBar.setSteps(data.animationData.length);\r\n        }\r\n    }\r\n    data.registerCallback(reloadScene);\r\n\r\n    function loadFont() {\r\n        var loader = new THREE.FontLoader();\r\n        loader.load(\r\n            'https://threejs.org//examples/fonts/helvetiker_regular.typeface.json',\r\n            fontLoadingComplete\r\n        );\r\n    }\r\n\r\n    function fontLoadingComplete(font) {\r\n        fontResource = font;\r\n        reloadScene();\r\n    }\r\n\r\n    function reloadScene() {\r\n        clearScene();\r\n        reloadDataPoints();\r\n        reloadArrows();\r\n        buildProgressBar();\r\n        updatePanel();\r\n    }\r\n\r\n    function updatePanel() {\r\n        data.skipSteps = data.skipSteps || 1;\r\n        data.stepDelay = data.stepDelay || 300;\r\n        data.valueMax = data.valueMax || 1;\r\n        data.fluxMax = data.fluxMax || 1;\r\n        data.color = data.color || [70, 156, 150, 1];\r\n        data.radius = data.radius || origRadius;\r\n        radius = data.radius;\r\n        halfQuantity = data.valueMax / 2.0;\r\n        halfFlux = data.fluxMax / 2.0;\r\n        controls.size = data.radius;\r\n        controls.skipSteps = data.skipSteps;\r\n        controls.valueMax = data.valueMax;\r\n        controls.fluxMax = data.fluxMax;\r\n        controls.stepDelay = data.stepDelay;\r\n        controls.color = data.color;\r\n        datGui.updateDisplay();\r\n    }\r\n\r\n    function clearScene() {\r\n        let remove = [];\r\n        scene.traverse((child) => {\r\n            if (child instanceof THREE.Mesh || child instanceof THREE.ArrowHelper) {\r\n                remove.push(child);\r\n            }\r\n        });\r\n        for (let i = 0; i < remove.length; i++) {\r\n            scene.remove(remove[i]);\r\n        }\r\n    }\r\n\r\n    function reloadArrows() {\r\n        let hydratedArrows = [];\r\n        let legacyArrowIndex = 0;\r\n        data.arrows.forEach(oldArrow => {\r\n            hydratedArrows.push(restoreArrow(oldArrow, legacyArrowIndex++));\r\n        });\r\n        data.arrows = hydratedArrows;\r\n    }\r\n\r\n    function reloadDataPoints() {\r\n        let hydratedPoints = [];\r\n        let c = 0;\r\n        data.dataPoints.forEach(oldPoint => {\r\n            if (!oldPoint.dataIndex) { // For converting legacy saves on the fly\r\n                oldPoint.dataIndex = c++;\r\n            }\r\n            let point = restoreDataPoint(oldPoint);\r\n            hydratedPoints.push(point);\r\n            point.moveText(point.object.mesh.position.x, point.object.mesh.position.y);\r\n        });\r\n        data.dataPoints = hydratedPoints;\r\n    }\r\n\r\n    function buildGUI() {\r\n        var gui = new dat.GUI({\r\n            autoPlace: false\r\n        });\r\n        var customContainer = document.getElementById('datGuiAnchor');\r\n        customContainer.appendChild(gui.domElement);\r\n        gui.domElement.id = 'datGuiAnchor';\r\n        gui.add(controls, 'seekHelp').name(\"Help\");\r\n        var animation = gui.addFolder(\"Animation\");\r\n        buildAnimationFolder(animation);\r\n        var editing = gui.addFolder(\"Model Editing\");\r\n        buildEditingFolder(editing);\r\n        var interpretation = gui.addFolder(\"Interpretation\");\r\n        buildInterpretationFolder(interpretation);\r\n        return gui;\r\n    }\r\n\r\n    function buildAnimationFolder(folder) {\r\n        folder.add(controls, 'changeStep').name(\"\\u21E5 Step Forward\");\r\n        folder.add(controls, 'startAnimation').name(\"\\u25B6 Start\");\r\n        folder.add(controls, 'pauseAnimation').name(\"\\u23F8 Pause\");\r\n        folder.add(controls, 'resetAnimation').name(\"\\u21BB Reset\");\r\n        var timeController = folder.add(controls, 'stepDelay').name(\"Delay (in ms)\").min(0).max(500).step(10)\r\n        timeController.onChange(function (newValue) {\r\n            data.stepDelay = newValue;\r\n        });\r\n        folder.add(controls, 'skipSteps').name(\"Step Size\").onChange(function (newValue) {\r\n            data.skipSteps = newValue;\r\n        });\r\n        return folder;\r\n    }\r\n\r\n    function buildEditingFolder(editFolder) {\r\n        editFolder.add(controls, 'generateCompartments').name(\"Generate Comps.\");\r\n        editFolder.add(controls, 'editMode').name(\"Edit Mode\").onChange(function (newValue) {\r\n            editMode = newValue;\r\n        });\r\n        editFolder.add(controls, 'labelMode').name(\"Import Labels\").onChange(function (newValue) {\r\n            data.labelMode = newValue;\r\n        });\r\n        editFolder.add(controls, 'showIndices').name(\"Show Indices\").onChange(function (show) {\r\n            showIndices(show);\r\n        });\r\n        editFolder.add(controls, 'compIndex').name(\"Data Index\").listen().onFinishChange(function (newValue) {\r\n            if (dataPointToDelete !== -1) {\r\n                if ((newValue > data.dataPoints.length) || (newValue < 1)) {\r\n                    alert(\"Invalid Index\");\r\n                } else {\r\n                    data.dataPoints[dataPointToDelete].dataIndex = newValue;\r\n                    scene.remove(data.dataPoints[dataPointToDelete].indexTextMesh);\r\n                    if (controls.showIndices) {\r\n                        data.dataPoints[dataPointToDelete].showIndex(fontResource);\r\n                        scene.add(data.dataPoints[dataPointToDelete].indexTextMesh);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        editFolder.add(controls, 'label').name(\"Comp. Label\").listen().onFinishChange(function (newValue) {\r\n            scene.remove(data.dataPoints[dataPointToDelete].textMesh);\r\n            data.dataPoints[dataPointToDelete].appendText(fontResource, newValue, data.dataPoints[dataPointToDelete].position.x, data.dataPoints[dataPointToDelete].position.y);\r\n            scene.add(data.dataPoints[dataPointToDelete].textMesh);\r\n        });\r\n        editFolder.add(controls, 'addPoint').name(\"Add Compartment\");\r\n        editFolder.add(controls, 'addArrow').name(\"Add Arrow\");\r\n        editFolder.add(controls, 'deletePoint').name(\"Delete Compartment\");\r\n        var sizeController = editFolder.add(controls, 'size').name(\"Size\").min(10).max(100).step(1);\r\n        sizeController.onChange(function (newValue) {\r\n            radius = newValue; //Ratio of original size\r\n            data.radius = radius;\r\n            changeAllRadius();\r\n        });\r\n        return editFolder;\r\n    }\r\n\r\n    function buildInterpretationFolder(folder) {\r\n        var maxController = folder.add(controls, 'valueMax').name(\"Comp. Maximum\");\r\n        maxController.onChange(function (newValue) {\r\n            data.valueMax = newValue;\r\n            halfQuantity = data.valueMax / 2.0;\r\n        });\r\n        var maxFluxController = folder.add(controls, 'fluxMax').name(\"Flux Maximum\");\r\n        maxFluxController.onChange(function (newValue) {\r\n            data.fluxMax = newValue;\r\n            halfFlux = data.fluxMax / 2.0;\r\n        });\r\n        var colorController = folder.addColor(controls, 'color').name(\"50% Max Color\");\r\n        colorController.onChange(function (newValue) {\r\n            baseColor = newValue;\r\n            changeColor(baseColor);\r\n        })\r\n        return folder;\r\n    }\r\n\r\n    function buildProgressBar() {\r\n        let rect = canvas.getBoundingClientRect();\r\n        progressBar = new ProgressBar(scene, fontResource, (-rect.height / 2.0) + 25);\r\n        progressBar.appendText(\"0\");\r\n    }\r\n\r\n    function setupEventListeners() {\r\n        canvas.addEventListener(\"mousedown\", function (evt) {\r\n            mouseDown = true;\r\n            checkWithinRange(canvas, evt);\r\n        });\r\n        canvas.addEventListener(\"mouseup\", function (evt) {\r\n            if (editMode) {\r\n                if (arrowMode === 1) {\r\n                    arrowMode = 2;\r\n                    checkWithinRange(canvas, evt);\r\n                    if ((arrowPoints[0] != null) && (arrowPoints[1] != null)) {\r\n                        addArrow();\r\n                    } else {\r\n                        alert(\"Dragged line was not between two data points\");\r\n                    }\r\n                    //Reset arrow points\r\n                    arrowPoints[0] = null;\r\n                    arrowPoints[1] = null;\r\n                }\r\n                mouseDown = false;\r\n                dataPointToMove = -1; //No current selected dataPoint\r\n            }\r\n            if (data.arrows.length > 0) {\r\n                updateArrows(-1);\r\n            }\r\n        });\r\n        canvas.addEventListener(\"mousemove\", function (evt) {\r\n            if (editMode) {\r\n                if (mouseDown) {\r\n                    var mousePos = getMousePos(canvas, evt);\r\n                    var newMousePos = canvasToThreePos(mousePos);\r\n                    if (dataPointToMove > -1) {\r\n                        data.dataPoints[dataPointToMove].setPosition(newMousePos.x, newMousePos.y, 0);\r\n                        data.dataPoints[dataPointToMove].moveText(newMousePos.x, newMousePos.y);\r\n                        if (controls.showIndices) {\r\n                            data.dataPoints[dataPointToMove].moveIndexText(newMousePos.x, newMousePos.y + (3 / 4) * (data.dataPoints[dataPointToMove].radius));\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    function checkWithinRange(canvas, evt) {\r\n        var mousePos = canvasToThreePos(getMousePos(canvas, evt));\r\n        //Check if click was on data point\r\n        controls.compIndex = \"\"; //Clear\r\n        controls.label = \"\"; //Clear\r\n        if (editMode) {\r\n            for (var i = 0; i < data.dataPoints.length; i++) {\r\n                var selected = data.dataPoints[i].withinCircle(mousePos.x, mousePos.y);\r\n                if (selected && arrowMode === 1) {\r\n                    arrowPoints[0] = i\r\n                } else if (selected && arrowMode === 2) {\r\n                    arrowPoints[1] = i\r\n                } else if (selected) {\r\n                    dataPointToMove = i;\r\n                    controls.compIndex = data.dataPoints[i].dataIndex;\r\n                    controls.label = data.dataPoints[i].labelText;\r\n                    dataPointToDelete = i;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (dataPointToMove === -1 && progressBar) { //Click was not on a datapoint\r\n            dataPointToDelete = -1; //Deselect previous selection\r\n            if (data.animationData && !isDataLoaded()) {\r\n                alert(\"Please import data first\");\r\n                return;\r\n            }\r\n\r\n            //Check if click was on progress bar\r\n            if (progressBar.withinBar(mousePos.x, mousePos.y) && data.animationData) {\r\n                var clickedStep = progressBar.getStep(mousePos.x);\r\n                let text = data.animationData[clickedStep - 1];\r\n                progressBar.updateProgress(clickedStep, text ? text[0] : \"0\")\r\n                data.step = clickedStep - 1;\r\n                applyStep();\r\n            }\r\n        }\r\n    }\r\n\r\n    function getMousePos(canvas, evt) {\r\n        var rect = canvas.getBoundingClientRect();\r\n        return {\r\n            x: evt.clientX - rect.left,\r\n            y: evt.clientY - rect.top\r\n        };\r\n    }\r\n\r\n    function canvasToThreePos(mousePos) {\r\n        var rect = canvas.getBoundingClientRect();\r\n        var newX, newY;\r\n        newX = (rect.width / 2) - mousePos.x;\r\n        newY = mousePos.y - (rect.height / 2);\r\n        return {\r\n            x: newX,\r\n            y: newY\r\n        };\r\n    }\r\n\r\n    function buildScene() {\r\n        setupEventListeners();\r\n        const scene = new THREE.Scene();\r\n        scene.background = new THREE.Color(\"#FFF\");\r\n        return scene;\r\n    }\r\n\r\n    function buildRender({\r\n        width,\r\n        height\r\n    }) {\r\n        const renderer = new THREE.WebGLRenderer({\r\n            canvas: canvas,\r\n            antialias: true,\r\n            alpha: true\r\n        });\r\n        const DPR = window.devicePixelRatio ? window.devicePixelRatio : 1;\r\n        renderer.setPixelRatio(DPR);\r\n        renderer.setSize(width, height);\r\n\r\n        renderer.gammaInput = true;\r\n        renderer.gammaOutput = true;\r\n\r\n        return renderer;\r\n    }\r\n\r\n    function buildCamera({\r\n        width,\r\n        height\r\n    }) {\r\n        var camera = new THREE.OrthographicCamera(width / -2, width / 2, height / -2, height / 2, 1, 1000);\r\n        camera.position.set(0, 0, -10);\r\n        camera.lookAt(origin)\r\n        return (camera);\r\n    }\r\n\r\n    function isDataLoaded() {\r\n        if (data && !data.dataLoaded()) {\r\n            alert(\"Please import data first\");\r\n        }\r\n        return data.dataLoaded();\r\n    }\r\n\r\n    async function startStepping(singleStep = false) {\r\n        if (isDataLoaded()) {\r\n            paused = false;\r\n            stepForward(singleStep);\r\n        }\r\n    }\r\n\r\n    async function stepForward(singleStep = false) {\r\n        if (data.hasNextStep()) {\r\n            if (!paused) {\r\n                applyStep();\r\n                data.step += stepInc;\r\n                await actionUtil.sleep(data.stepDelay);\r\n                if (!singleStep)\r\n                    stepForward();\r\n            }\r\n        }\r\n    }\r\n\r\n    function applyStep() {\r\n        let text = data.step < 0 ? '0' : data.animationData[data.step][0];\r\n        if (data.step >= 0) {\r\n            colorPoints();\r\n        }\r\n        progressBar.updateProgress(data.step + 1, text);\r\n    }\r\n\r\n    function colorPoints() {\r\n        let changePercent, diff;\r\n\r\n        for (let i = 0; i < data.dataPoints.length; i++) {\r\n            if (data.animationData[data.step][data.dataPoints[i].dataIndex] > halfQuantity) { //i+1 because column 0 holds time info\r\n                //Darken\r\n                diff = data.animationData[data.step][data.dataPoints[i].dataIndex] - halfQuantity;\r\n                changePercent = diff / halfQuantity;\r\n                data.dataPoints[i].darkenColor(changePercent * 50); //Multiply by 50 - percent available to darken by\r\n            } else {\r\n                //Lighten\r\n                diff = halfQuantity - data.animationData[data.step][data.dataPoints[i].dataIndex];\r\n                changePercent = diff / halfQuantity;\r\n                data.dataPoints[i].lightenColor(changePercent * 50); //Multiply by 50 - percent available to lighten by\r\n            }\r\n        }\r\n        if (data.fluxData != null) {\r\n            for (let i = 0; i < data.arrows.length; i++) {\r\n                if (data.fluxData[data.step][data.arrows[i].dataIndex] > halfFlux) { //i+1 because column 0 holds time info\r\n                    //Darken\r\n                    diff = data.fluxData[data.step][data.arrows[i].dataIndex] - halfFlux;\r\n                    changePercent = diff / halfFlux;\r\n                    scene.remove(data.arrows[i].object);\r\n                    data.arrows[i].darkenColor(changePercent * 50); //Multiply by 50 - percent available to darken by\r\n                    scene.add(data.arrows[i].object) //Add newly colored arrow\r\n                } else {\r\n                    //Lighten\r\n                    diff = halfFlux - data.fluxData[data.step][data.dataPoints[i].dataIndex];\r\n                    changePercent = diff / halfFlux;\r\n                    scene.remove(data.arrows[i].object);\r\n                    data.arrows[i].lightenColor(changePercent * 50); //Multiply by 50 - percent available to lighten by\r\n                    scene.add(data.arrows[i].object) //Add newly colored arrow\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function restoreArrow(savedData, legacyIndex) {\r\n        let arrow = new FluxArrow(savedData.arrowInfo, legacyIndex);\r\n        scene.add(arrow.object);\r\n        return arrow;\r\n    }\r\n\r\n    function restoreDataPoint(savedData) {\r\n        // let labels = data.labels;\r\n        let dataPoint = new DataPoint(savedData.dataIndex, savedData); //TODO index\r\n        scene.add(dataPoint.object.mesh);\r\n        scene.add(dataPoint.shadow.mesh);\r\n        let labelText = savedData.textMesh ? savedData.textMesh.geometries[0].text : \" \";\r\n        if (!labelText)\r\n            labelText = \" \";\r\n        dataPoint.appendText(fontResource, labelText, dataPoint.position.x, dataPoint.position.y);\r\n        scene.add(dataPoint.textMesh);\r\n        // labels.push(labelText);\r\n        return dataPoint;\r\n    }\r\n\r\n    function addPoint() {\r\n        let labels = data.labels;\r\n        let labelMode = data.labelMode;\r\n        let dataPoints = data.dataPoints;\r\n        var labelText;\r\n        if (labelMode && labels.length > dataPoints.length + 1) {\r\n            labelText = labels[dataPoints.length + 1]\r\n        } else {\r\n            if (labelMode && labels.length <= dataPoints.length) {\r\n                labelText = window.prompt(\"Imported data does not contain a column #\" + dataPoints.length + \".\\nPlease label your data point: \");\r\n\r\n            } else {\r\n                labelText = window.prompt(\"Label your data point: \");\r\n            }\r\n        }\r\n        if ((!labelText) || (labelText === \"\")) {\r\n            alert(\"No label entered\");\r\n            return;\r\n        }\r\n        addDataPoint(labelText);\r\n    }\r\n\r\n    function addDataPoint(labelText) {\r\n        let dataPoints = data.dataPoints;\r\n        let dataPoint = new DataPoint(dataPoints.length + 1);\r\n        scene.add(dataPoint.object.mesh);\r\n        scene.add(dataPoint.shadow.mesh);\r\n        if (controls.showIndices) {\r\n            dataPoint.showIndex(fontResource);\r\n            scene.add(dataPoint.indexTextMesh);\r\n        }\r\n\r\n        dataPoint.changeColor(baseColor);\r\n        dataPoint.adjustScale(radius);\r\n        dataPoint.appendText(fontResource, labelText, dataPoint.position.x, dataPoint.position.y);\r\n        scene.add(dataPoint.textMesh);\r\n        dataPoints.push(dataPoint);\r\n        dataPoint.setPosition(0, 0, 0);\r\n        dataPoint.moveText(0, 0);\r\n    }\r\n\r\n    function removeFromScene(dataPoint) {\r\n        scene.remove(dataPoint.object.mesh);\r\n        scene.remove(dataPoint.shadow.mesh);\r\n        scene.remove(dataPoint.textMesh);\r\n    }\r\n\r\n    function addArrow() {\r\n        let arrows = data.arrows;\r\n        var shift = false;\r\n        //Check if new arrow is between an already arrowed combination\r\n        for (var i = 0; i < arrows.length; i++) {\r\n            if (arrows[i].arrowInfo.pointIndex1 === arrowPoints[0] && arrows[i].arrowInfo.pointIndex2 === arrowPoints[1]) {\r\n                //Arrow already exists in that direction-- do nothing\r\n                return\r\n            }\r\n            if (arrows[i].arrowInfo.pointIndex1 === arrowPoints[1] && arrows[i].arrowInfo.pointIndex2 === arrowPoints[0]) {\r\n                //Arrow exists in opposite direction-- shift new arrow\r\n                shift = true;\r\n            }\r\n        }\r\n        var arrowInfo = {\r\n            shift: shift,\r\n            len: 200,\r\n            pointIndex1: arrowPoints[0],\r\n            pointIndex2: arrowPoints[1],\r\n            point1: data.dataPoints[arrowPoints[0]].position,\r\n            point2: data.dataPoints[arrowPoints[1]].position,\r\n            dataPointRadius: radius,\r\n            dataIndex: data.arrows.length + 1,\r\n        }\r\n        let arrow = new FluxArrow(arrowInfo);\r\n        scene.add(arrow.object);\r\n        if (controls.showIndices) {\r\n            arrow.showIndex(fontResource);\r\n            scene.add(arrow.indexTextMesh);\r\n        }\r\n        arrowMode = 0;\r\n        arrows.push(arrow);\r\n    }\r\n\r\n    function updateArrows(deletedDataPoint) {\r\n        let arrows = data.arrows;\r\n        for (var i = 0; i < arrows.length; i++) {\r\n            var index1 = arrows[i].arrowInfo.pointIndex1;\r\n            var index2 = arrows[i].arrowInfo.pointIndex2;\r\n            if ((index1 === deletedDataPoint) || (index2 === deletedDataPoint)) {\r\n                scene.remove(arrows[i].object)\r\n                arrows.splice(i, 1);\r\n                i--; //To go back and check arrow that just moved into i'th position\r\n            } else {\r\n                if ((index1 > deletedDataPoint) && (deletedDataPoint !== -1)) {\r\n                    index1--;\r\n                    arrows[i].arrowInfo.pointIndex1--;\r\n                }\r\n                if ((index2 > deletedDataPoint) && (deletedDataPoint !== -1)) {\r\n                    index2--;\r\n                    arrows[i].arrowInfo.pointIndex2--;\r\n                }\r\n                arrows[i].updatePos(data.dataPoints[index1].position, data.dataPoints[index2].position);\r\n                if (controls.showIndices) {\r\n                    arrows[i].moveIndexText(arrows[i].position.x, arrows[i].position.y);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function deleteDataPoint() {\r\n        if (dataPointToDelete > -1) {\r\n            removeFromScene(data.dataPoints[dataPointToDelete]);\r\n            data.dataPoints.splice(dataPointToDelete, 1);\r\n            // data.labels.splice(dataPointToDelete, 1);\r\n        }\r\n        updateArrows(dataPointToDelete);\r\n    }\r\n\r\n    function changeColor(newColor) {\r\n        data.color = newColor;\r\n        for (var i = 0; i < data.dataPoints.length; i++) {\r\n            data.dataPoints[i].changeColor(newColor);\r\n        }\r\n    }\r\n\r\n    function changeAllRadius() {\r\n        let point;\r\n        for (let i = 0; i < data.dataPoints.length; i++) {\r\n            point = data.dataPoints[i];\r\n            point.adjustScale(radius);\r\n            point.changeTextSize(radius)\r\n            point.moveText(point.object.mesh.position.x, point.object.mesh.position.y);\r\n        }\r\n        for (let i = 0; i < data.arrows.length; i++) {\r\n            data.arrows[i].adjustScale(radius);\r\n        }\r\n    }\r\n\r\n    function showIndices(show) {\r\n        if (show) {\r\n            for (let i = 0; i < data.dataPoints.length; i++) {\r\n                data.dataPoints[i].showIndex(fontResource);\r\n                scene.add(data.dataPoints[i].indexTextMesh);\r\n            }\r\n            for (let i = 0; i < data.arrows.length; i++) {\r\n                data.arrows[i].showIndex(fontResource);\r\n                scene.add(data.arrows[i].indexTextMesh);\r\n            }\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < data.dataPoints.length; i++) {\r\n            scene.remove(data.dataPoints[i].indexTextMesh);\r\n        }\r\n        for (let i = 0; i < data.arrows.length; i++) {\r\n            scene.remove(data.arrows[i].indexTextMesh);\r\n        }\r\n\r\n    }\r\n\r\n    function generateCompartments() {\r\n        if (data.animationData == null) {\r\n            alert(\"Compartment data must be uploaded first\");\r\n            return;\r\n        } else if (data.dataPoints.length > 0) {\r\n            alert(\"Compartments already exist\");\r\n            return;\r\n        }\r\n        var rect = canvas.getBoundingClientRect();\r\n        var freeSpace = rect.width - (data.animationData[0].length * (radius * 2)) - 2 * radius; // - 2*radius allocates for a radius buffer space on each end\r\n        var spaceBetween = freeSpace / (data.animationData[0].length - 1);\r\n        for (var i = 0; i < data.animationData[0].length; i++) {\r\n            let xPos = -((rect.width / 2) - radius) + (i * radius * 2) + (i * spaceBetween) + radius; // + radius gives a radius buffer space on each end\r\n            let label = !!data.labels[i+1] ? data.labels[i+1] : (i + 1).toString();\r\n            addDataPoint(label);\r\n            //Move to appropriate location\r\n            data.dataPoints[i].setPosition(-xPos, -1, 0);\r\n            data.dataPoints[i].moveText(-xPos, 0);\r\n            if (controls.showIndices) {\r\n                data.dataPoints[i].moveIndexText(-xPos, (3 / 4) * (data.dataPoints[dataPointToMove].radius));\r\n            }\r\n        }\r\n    }\r\n\r\n    function update() {\r\n        renderer.render(scene, camera);\r\n    }\r\n\r\n    return {\r\n        update\r\n    }\r\n}","import React, {\r\n  Component\r\n} from 'react';\r\nimport threeEntryPoint from '../lib/threejs/threeEntryPoint';\r\n\r\n/* Imported From: https://itnext.io/how-to-use-plain-three-js-in-your-react-apps-417a79d926e0 */\r\nexport default class ThreeContainer extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.dataContext = this.props.dataContext;\r\n  }\r\n\r\n  componentDidMount() {\r\n    threeEntryPoint(this.threeRootElement, this.dataContext);\r\n  }\r\n\r\n  render() {\r\n    return ( <div  className='canvas' ref={element => this.threeRootElement = element} > </div>);\r\n  }\r\n}","/** Imported From:  https://github.com/PierfrancescoSoffritti/pierfrancescosoffritti.com/blob/master/src/components/home/header/threejs/threeEntryPoint.js*/\r\nimport SceneManager from './SceneManager';\r\n// import DataContext from './DataContext';\r\n\r\nexport default (container, dataContext) => {\r\n    const canvas = createCanvas(document, container);\r\n    const sceneManager = new SceneManager(canvas, dataContext);\r\n\r\n    render();\r\n\r\n    function createCanvas(document, container) {\r\n        const canvas = document.createElement('canvas');  \r\n        canvas.width = container.scrollWidth;\r\n        canvas.height = container.scrollHeight;\r\n        container.appendChild(canvas);\r\n        return canvas;\r\n    }\r\n   \r\n    function render() {\r\n        requestAnimationFrame(render);\r\n        sceneManager.update();\r\n    }\r\n}","export default class FileUtilities {\r\n\r\n  processXLSXIntoCSV(xlsxFile, onComplete) {\r\n    var reader = new FileReader();\r\n    reader.readAsBinaryString(xlsxFile);\r\n    reader.onload = () => {\r\n      var csvSheetStrings = this.transformXLXSIntoCsvStrings(reader.result);\r\n      onComplete(this.parseSingleCSV(csvSheetStrings[0]));\r\n    }\r\n  }\r\n\r\n  processPlotsData(file, onComplete){\r\n    var reader = new FileReader();\r\n    reader.readAsText(file);\r\n    reader.onload = () => {\r\n      let text = reader.result;\r\n      onComplete(JSON.parse(text));\r\n    }\r\n  }\r\n\r\n  transformXLXSIntoCsvStrings(binaryContents) {\r\n    const XLSX = require('xlsx')\r\n    const binaryType = {\r\n      type: 'binary'\r\n    };\r\n    var csvStrings = [];\r\n    var workbook = XLSX.read(binaryContents, binaryType);\r\n    workbook.SheetNames.forEach(name => {\r\n      csvStrings.push(XLSX.utils.sheet_to_csv(workbook.Sheets[name]));\r\n    });\r\n\r\n    return csvStrings;\r\n  }\r\n\r\n  parseSingleCSV(csvString) {\r\n    var numOfRows = 0;\r\n    var numOfColumns = 1;\r\n    var ch, i;\r\n    //Count rows\r\n    for (i = 0; i < csvString.length; i++) {\r\n      ch = csvString.charAt(i);\r\n      if (ch === '\\n') {\r\n        numOfRows++\r\n      }\r\n    }\r\n    //Count columns\r\n    ch = '';\r\n    i = 0;\r\n    while (ch !== '\\n') {\r\n      ch = csvString.charAt(i);\r\n      if (ch === ',') {\r\n        numOfColumns++;\r\n      }\r\n      i++;\r\n    }\r\n    //Create 2D array to hold xlsx data\r\n    this.data = new Array(numOfRows);\r\n    for (i = 0; i < numOfRows; i++) {\r\n      this.data[i] = new Array(numOfColumns);\r\n    }\r\n    //Fill array\r\n    for (i = 0; i < this.data.length; i++) {\r\n      var rows = csvString.split(\"\\n\");\r\n      this.data[i] = rows[i].split(\",\");\r\n    }\r\n    //Remove multiple label rows, starting at 1 (after first label row)\r\n    for (i = 1; i < this.data.length; i++){\r\n      if ((this.data[i][0] === \"t\") || (this.data[i][1] === \"-\")) {\r\n        this.data.splice(i, 1);\r\n      }\r\n    }\r\n    return this.data;\r\n  }\r\n}","import React from 'react';\r\nimport FormGroup from 'react-bootstrap/lib/FormGroup';\r\nimport FormControl from 'react-bootstrap/lib/FormControl';\r\nimport ControlLabel from 'react-bootstrap/lib/ControlLabel';\r\nimport FileUtilities from '../lib/FileUtilities';\r\nimport NavItem from 'react-bootstrap/lib/NavItem';\r\n\r\nexport default class FileInput extends NavItem {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.title = this.props.title || \"Upload file\";\r\n    this.processUpload = this.processUpload.bind(this);\r\n    this.state = { callback: this.props.onDone, accept: this.props.accept, plot: this.props.isPlot };\r\n  }\r\n\r\n  hasNoFiles(files){\r\n    return files.length === 0;\r\n  }\r\n\r\n  processUpload(e){\r\n    if(this.state.plot)\r\n      this.readPlots(e.target.files, this.state.callback);\r\n    else\r\n      this.readXLSX(e.target.files, this.state.callback);\r\n  }\r\n\r\n  readPlots(files, callback){\r\n    const call = callback;\r\n    let fileUtil = new FileUtilities();\r\n    if(files.length === 0)\r\n      return;\r\n    fileUtil.processPlotsData(files[0], function(dataString){\r\n       call(dataString);\r\n    });\r\n  }\r\n\r\n  readXLSX(files, callback){\r\n    const call = callback;\r\n    let fileUtil = new FileUtilities();\r\n    if(this.hasNoFiles(files))\r\n      return;\r\n    fileUtil.processXLSXIntoCSV(files[0], function(dataString){\r\n       call(dataString);\r\n    });\r\n  }\r\n\r\n  render () {\r\n      return (\r\n        <FormGroup>\r\n         <ControlLabel htmlFor={this.title} style={{ cursor: \"pointer\" }}>\r\n              {this.title}\r\n              <FormControl id={this.title}\r\n                           type=\"file\" \r\n                           accept={this.accept}\r\n                           onChange={this.processUpload} \r\n                           ref={input => {this.fileInput = input;}} \r\n                           style={{ display: \"none\" }} />\r\n          </ControlLabel>\r\n        </FormGroup>\r\n      );\r\n  }\r\n}\r\n        ","export class PlotData {\r\n    constructor(id = \"untracked\") {\r\n        this.id = id;\r\n        this.dataPoints = [];\r\n        this.labels = [];\r\n        this.arrows = [];\r\n        this.step = 0;\r\n        this.fluxMax = 1;\r\n        this.valueMax = 1;\r\n        this.stepDelay = 300;\r\n        this.radius = 40;\r\n        this.color = [70, 156, 150, 1];\r\n        this.skipSteps = 1;\r\n    }\r\n}\r\n\r\nexport default PlotData;","import PlotData from './threejs/PlotData';\r\nimport localforage from 'localforage';\r\n\r\nconst WEB_STORAGE_KEY = \"plots\";\r\n\r\nexport default class LocalStorage {\r\n\r\n    async addNewModelToLocal(modelName){\r\n        let model = this.newModelTemplate(modelName);\r\n        let models = await this.loadModelsFromDefaultContainer();\r\n        models.push(model);\r\n        await this.saveToStore(WEB_STORAGE_KEY, models, \"Failed to add a new model\").catch(() => {return model}); \r\n        return model;\r\n    }\r\n\r\n    async saveToStore(key, value, failureMsg = \"Failed to write to storage\"){\r\n        try {\r\n            await localforage.setItem(key, \"!\" + JSON.stringify(value));\r\n        } catch (error) {\r\n            alert(failureMsg + String(error));\r\n        }\r\n    }\r\n\r\n    async fetchFromStore(key, failureMsg = \"Failed to fetch from storage\"){\r\n        try {\r\n            let result = await localforage.getItem(key);\r\n            if(!result)\r\n                return null;\r\n            return JSON.parse(result.substring(1));\r\n        } catch (error) {\r\n            alert(failureMsg + \": \" + String(error));            \r\n        }\r\n    }\r\n\r\n    //  item must have name of plot\r\n    //  addition must be PlotData\r\n    async updateStorage(name, addition){\r\n        let models = await this.loadModelsFromDefaultContainer();\r\n        for (const modelId in models) {\r\n            if (models.hasOwnProperty(modelId) && models[modelId].name === name) {\r\n                const element = models[modelId];\r\n                let id = element.versions.length + 1;\r\n                addition.id = name + id;\r\n                element.versions = [this.newModelVersion(addition)];\r\n            }\r\n        }\r\n        this.saveToStore(WEB_STORAGE_KEY, models, \"Failed to save the models\");\r\n    }\r\n    \r\n    async removeFromStorage(name){\r\n        let models = await this.loadModelsFromDefaultContainer();\r\n        let reducedList = [];\r\n        for (const modelId in models) {\r\n            if (models.hasOwnProperty(modelId)) {\r\n                if(models[modelId].name !== name){\r\n                    reducedList.push(models[modelId]);\r\n                }\r\n            }\r\n        }\r\n        this.saveToStore(WEB_STORAGE_KEY, reducedList, \"Failed to save the models\");\r\n    }\r\n\r\n    async loadFromStorage() {\r\n        let models = await this.loadModelsFromDefaultContainer();\r\n        if(models.length === 0){\r\n            models.push(this.newModelTemplate());\r\n            this.saveToStore(WEB_STORAGE_KEY, models, \"Failed to save the models\");\r\n        }\r\n        return models;\r\n    }\r\n\r\n    async loadModelsFromDefaultContainer(){\r\n        let models = await this.fetchFromStore(WEB_STORAGE_KEY, \"Failed to Access Memory\").catch();\r\n        if (!models || !models.length) {\r\n            models = [];\r\n        }\r\n        return models;\r\n    }\r\n    \r\n    async writeToLocalStorage(dataArray){\r\n        if (!dataArray || !dataArray.length) {\r\n            dataArray = [];\r\n        }\r\n        await this.saveToStore(WEB_STORAGE_KEY, dataArray);\r\n    }\r\n\r\n    newModelTemplate(name = \"Default Storage\") {\r\n       return {\r\n                name: name,\r\n                versions: [this.newModelVersion(new PlotData(name + \".\" + 1))]\r\n            };\r\n    }\r\n\r\n    newModelVersion(model){\r\n        return {\r\n            plot: model\r\n        }\r\n    }\r\n\r\n}","import React, { Component } from 'react';\r\nimport Navbar from 'react-bootstrap/lib/Navbar';\r\nimport Image from 'react-bootstrap/lib/Image';\r\nimport FormGroup from 'react-bootstrap/lib/FormGroup';\r\nimport ControlLabel from 'react-bootstrap/lib/ControlLabel';\r\nimport Form from 'react-bootstrap/lib/Form';\r\nimport FileInput from './FileInput';\r\nimport localStorage from '../lib/LocalStorage';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\n\r\nclass Navigation extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.IController = this.props.IController;\r\n    this.dataContext = this.props.dataContext;\r\n\r\n    this.uploadPoints = this.uploadDataPoints.bind(this);\r\n    this.uploadFlux = this.uploadFluxData.bind(this);\r\n    this.processUpload = this.processUpload.bind(this);\r\n  }\r\n\r\n  async downloadLocalStorage(){\r\n    toast(\"Prepping Download\", { \r\n      position: toast.POSITION.TOP_LEFT\r\n    });\r\n    let data = JSON.stringify(await (new localStorage()).loadModelsFromDefaultContainer());\r\n    var blobData = new Blob([data], {type: 'text/plain'});\r\n    let textFile = window.URL.createObjectURL(blobData);\r\n    let downloadAnchorNode = document.createElement('a');\r\n    downloadAnchorNode.setAttribute(\"href\", textFile);\r\n    downloadAnchorNode.setAttribute(\"download\", \"plots.json\");\r\n    document.body.appendChild(downloadAnchorNode);\r\n    downloadAnchorNode.click();\r\n    downloadAnchorNode.remove();\r\n  }\r\n\r\n  processUpload(e){\r\n    this.readPlots(e.target.files);\r\n  }\r\n\r\n  uploadDataPoints(data){\r\n      toast(\"Upload Point Data Complete\", { \r\n        position: toast.POSITION.TOP_LEFT\r\n      });\r\n      this.dataContext.injectDataPointList(data);\r\n  }\r\n\r\n  uploadFluxData(data) {\r\n    toast(\"Upload Flux Data Complete\", { \r\n      position: toast.POSITION.TOP_LEFT\r\n    });\r\n    this.dataContext.injectFluxList(data);\r\n  }\r\n\r\n  async  uploadModels(data) {\r\n    if(data && window.confirm(\"Warning! This will replace all of your models with the uploaded models. Continue?\")){\r\n      await (new localStorage()).writeToLocalStorage(data);\r\n      window.location.reload();\r\n      return;\r\n    }\r\n    toast(\"No Models Uploaded\", { \r\n      position: toast.POSITION.TOP_LEFT\r\n    });\r\n  }\r\n\r\n  render() {\r\n\r\n    let preventRedirect = e => {\r\n      e.preventDefault();\r\n    };\r\n\r\n    return (\r\n        <Navbar inverse id='mainNav'>\r\n          <Navbar.Header>\r\n            <Navbar.Brand className='nav-brand'>\r\n              <a href=\"https://github.com/staujd02/time_machine\">Compartmental Visualizer</a>\r\n            </Navbar.Brand>\r\n          </Navbar.Header>\r\n          <Form inline>\r\n            <FileInput className='nav-item' onDone={this.uploadPoints} isPlot={false} accept=\".xlsx\" onClick={preventRedirect} title={\"Upload Compartment Data\"}/>\r\n            <FileInput className='nav-item' onDone={this.uploadFlux} isPlot={false} accept=\".xlsx\" onClick={preventRedirect} title={\"Upload Flux Data\"}/>\r\n            <FileInput className='nav-item' onDone={this.uploadModels} isPlot={true} accept=\".json\" onClick={preventRedirect} title={\"Upload Models\"}/>\r\n            <FormGroup className='nav-item'>\r\n              <ControlLabel htmlFor=\"Export Models\" style={{ cursor: \"pointer\" }} onClick={this.downloadLocalStorage}>\r\n                    {\"Export Models\"}\r\n                    <ToastContainer autoClose={1500} />\r\n              </ControlLabel>\r\n            </FormGroup>\r\n          </Form>\r\n          <span> <Image className=\"logo\" src=\"./pfw-white.png\"></Image> </span>\r\n        </Navbar>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Navigation;","import React, { Component } from 'react';\r\nexport default class SavedPlot extends Component {\r\n\r\n  constructor(param){\r\n    super(param);\r\n    this.dataCapsule = this.props.dataCapsule;\r\n    this.name = this.dataCapsule.name;\r\n    this.className = this.props.className;\r\n  }\r\n\r\n  render() {\r\n    return ( \r\n        <div className={this.className}>{this.name}</div>\r\n    );\r\n  }\r\n}","import React, { Component } from 'react';\r\nimport SavedPlot from './SavedPlot';\r\nimport Button from 'react-bootstrap/lib/Button';\r\nimport LocalStorage from '../lib/LocalStorage';\r\nimport { toast } from 'react-toastify';\r\n\r\nexport default class StorageList extends Component {\r\n\r\n  constructor(param){\r\n    super(param);\r\n    const parent = this;\r\n    this.entries = [];\r\n    this.handleClick = this.handleClick.bind(this);\r\n    this.addToLocal = this.addToLocal.bind(this);\r\n    this.removeFromLocal = this.removeFromLocal.bind(this);\r\n    this.loadSaves = this.loadSaves.bind(this);\r\n    this.createButtonEntry = this.createButtonEntry.bind(this);\r\n    this.createEntryName = this.createEntryName.bind(this);\r\n    this.createGrid = this.createGrid.bind(this);\r\n    this.activeModelName = this.activeModelName.bind(this);\r\n    this.state = {dataContext: parent.props.dataContext};\r\n    this.loadSaves();\r\n  }\r\n\r\n  isActive(capsule){\r\n    return this.state.dataContext.currentPlot().id === capsule.versions[capsule.versions.length - 1].plot.id;\r\n  }\r\n\r\n  applyName(capsule){\r\n    return this.isActive(capsule) ? \"Save\" : \"Load\";\r\n  }\r\n\r\n  createButtonEntry(save){\r\n      return <Button key={this.entries.length} className=\"grid-item\" onClick={() => this.handleClick(save)}>{this.applyName(save)}</Button>;\r\n  }\r\n\r\n  createEntryName(save){\r\n      return <SavedPlot key={this.entries.length} className=\"grid-item\" dataCapsule={save}/>;\r\n  }\r\n\r\n  activeModelName(){\r\n    let model = \"\";\r\n    if(this.state.models){\r\n    this.state.models.forEach(s => {\r\n      if(this.isActive(s)){\r\n          model = s.name;\r\n      }\r\n    });\r\n    }\r\n    return \" \" + model;\r\n  }\r\n\r\n  async addToLocal(){\r\n    let resp = this.solictStorageName('you would like to add.');\r\n    if(!!resp){\r\n      await (new LocalStorage()).addNewModelToLocal(resp);\r\n      await this.loadSaves();\r\n      this.forceUpdate();\r\n    }\r\n  }\r\n  \r\n  async removeFromLocal(){\r\n    let resp = this.solictStorageName('you would like to permanently delete.');\r\n    if(!!resp){\r\n      await (new LocalStorage()).removeFromStorage(resp);\r\n      await this.loadSaves();\r\n      this.forceUpdate();\r\n      toast.success(\"Model Removed\");\r\n    }\r\n  }\r\n\r\n  solictStorageName(extension) {\r\n    return window.prompt('Please enter the name of Model ' + extension);\r\n  }\r\n\r\n  async handleClick(s) {\r\n    if(this.isActive(s)){\r\n      let plot = this.state.dataContext.currentPlot();\r\n      await (new LocalStorage()).updateStorage(s.name, plot);\r\n      toast.success(\"Model Saved\");\r\n    } else {\r\n      await this.loadSaves();\r\n      this.state.dataContext.currentPlot(s);\r\n      this.forceUpdate();\r\n    }\r\n  }\r\n\r\n  async loadSaves(){\r\n    this.entries = [];\r\n    let models = await (new LocalStorage()).loadFromStorage(this.ThreeController);\r\n    let dataContext = this.state.dataContext;\r\n    this.setState({\r\n        dataContext: dataContext,\r\n        models: models\r\n    });\r\n  }\r\n\r\n  createGrid(){\r\n    if(this.state.models){\r\n      this.entries = [];\r\n      this.state.models.forEach(s => {\r\n        this.entries.push(this.createEntryName(s));\r\n        this.entries.push(this.createButtonEntry(s));\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    this.createGrid();\r\n\r\n    return ( \r\n        <div>\r\n          <h4 className=\"model-list-banner\">Models</h4>\r\n          <h5 className=\"active-banner\"><span>Loaded Model: </span>{this.activeModelName()}</h5>\r\n          <div className=\"grid-container\">\r\n            {this.entries}\r\n          </div>\r\n          <div className=\"grid-container\">\r\n            <Button id=\"new-plot\" onClick={this.addToLocal}>New Model</Button>\r\n            <Button id=\"delete-plot\" onClick={this.removeFromLocal}>Delete Model</Button>\r\n          </div>\r\n        </div>\r\n    );\r\n  }\r\n}","export default (PlotData) => {\r\n\r\n    let context = {};\r\n\r\n    context.plot_id = PlotData.id;\r\n    \r\n    context.callbacks = [];\r\n    context.labelMode = false;\r\n    context.onLoad = null;\r\n    context.animationData = null;\r\n    context.fluxData = null;\r\n\r\n    Object.assign(context, PlotData);\r\n\r\n    context.callObservers = () => {\r\n        context.callbacks.forEach(call => {\r\n           call(); \r\n        });\r\n    };\r\n\r\n    context.registerCallback = (call) => {\r\n        context.callbacks.push(call);\r\n    };\r\n\r\n    context.currentPlot = (plot = null) => {\r\n        if(plot){\r\n            return context.loadPlot(plot.versions[plot.versions.length - 1].plot);\r\n        } else{\r\n            return {\r\n                id: context.plot_id,\r\n                dataPoints: context.dataPoints,\r\n                labels: context.labels,\r\n                arrows: context.arrows,\r\n                step: context.step,\r\n                valueMax: context.valueMax,\r\n                fluxMax: context.fluxMax,\r\n                stepDelay: context.stepDelay,\r\n                color: context.color,\r\n                skipSteps: context.skipSteps,\r\n                radius: context.radius\r\n            }\r\n        }\r\n    };\r\n\r\n    context.loadPlot = (plot) => {\r\n        Object.assign(context, plot);\r\n        context.plot_id = plot.id;\r\n        context.callObservers();\r\n        return plot;\r\n    };\r\n\r\n    context.injectDataPointList = json => loadPointData(json, context);\r\n    context.injectFluxList = json => loadFluxData(json, context);\r\n\r\n    context.dataLoaded = function dataLoaded() {\r\n        return context.animationData != null;\r\n    }\r\n\r\n    context.hasNextStep = function hasNextStep() {\r\n        return context.dataLoaded() && context.step < context.animationData.length;\r\n    }\r\n\r\n    return context;\r\n\r\n    function loadFluxData(xlsxData, instance) {\r\n        xlsxData.splice(0, 1); //Remove label column\r\n        instance.fluxData = xlsxData;\r\n        if (instance.onLoad && typeof instance.onLoad === \"function\")\r\n            instance.onLoad();\r\n    }\r\n\r\n    function loadPointData(xlsxData, instance) {\r\n        instance.labels = xlsxData[0];\r\n        xlsxData.splice(0, 1); //Remove label column\r\n        instance.animationData = xlsxData;\r\n        if (instance.onLoad && typeof instance.onLoad === \"function\")\r\n            instance.onLoad();\r\n    }\r\n\r\n}","import React, { Component } from 'react';\r\nimport './css/App.css';\r\nimport ThreeContainer from './components/ThreeContainer';\r\nimport Navigation from './components/Navigation';\r\nimport StorageList from './components/StorageList.js';\r\nimport LocalStorage from './lib/LocalStorage.js';\r\nimport Grid from 'react-bootstrap/lib/Grid';\r\nimport Row from 'react-bootstrap/lib/Row';\r\nimport Col from 'react-bootstrap/lib/Col';\r\nimport DataContext from './lib/threejs/DataContext';\r\n\r\nclass App extends Component {\r\n \r\n  constructor(props){\r\n    super(props);\r\n    this.ThreeController = {\r\n      resetDataAnimation: function() {},\r\n      onLoad: function() {},\r\n      onFluxLoad: function() {}\r\n    };\r\n    this.fetchSaves()\r\n  }\r\n\r\n  async fetchSaves(){\r\n    let saves = await ((new LocalStorage()).loadFromStorage(this.ThreeController));\r\n    console.log(saves);\r\n    let currentPlot = saves[0].versions[saves[0].versions.length - 1].plot;\r\n    let currentContext = new DataContext(currentPlot);\r\n    this.setState({\r\n      saves: saves,\r\n      currentPlot: currentPlot,\r\n      currentContext: currentContext\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if(!this.state || !this.state.currentContext)\r\n      return (<div>Loading From Storage</div>);\r\n\r\n    return (\r\n      <div className=\"app\">\r\n            <Grid fluid={true} className='fill'>\r\n              <Row>\r\n                  <Navigation dataContext={this.state.currentContext} IController={this.ThreeController} />\r\n              </Row>\r\n              <Row className='fill'>\r\n                <Col sm={2} md={2} className='sidebar'>\r\n                  <Row sm={2} md={2}>\r\n                    <div className='dat-style' id=\"datGuiAnchor\"></div>\r\n                  </Row>\r\n                  <Row sm={2} md={2}>\r\n                    <StorageList dataContext={this.state.currentContext} saves={this.saves}></StorageList>\r\n                  </Row>\r\n                </Col>\r\n                <Col sm={10} md={10} className='threeContainer'> \r\n                  <ThreeContainer dataContext={this.state.currentContext} IController={this.ThreeController}/> \r\n                </Col>\r\n              </Row>\r\n            </Grid>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;","// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport default function register() {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Lets check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './css/index.css';\r\nimport './css/bootstrap.min.css';\r\nimport App from './App';\r\nimport registerServiceWorker from './registerServiceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\nregisterServiceWorker();\r\n"],"sourceRoot":""}